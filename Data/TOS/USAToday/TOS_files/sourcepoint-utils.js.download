define(["jquery","underscore","utils","managers/autoplay","cookie"],function(i,e,s,o){"use strict";if(window._sp_){var t=function(){e.bindAll(this,"autoplay","spCallback","spChoiceCallback","buildProp41"),this.autoplayPromise=i.Deferred(),this.whitelist="n/a",this.recovery="n/a",this.msg_id="n/a",this.cmpgn_id="n/a",window._sp_.config=window._sp_.config||{},window._sp_.config.mms_client_data_callback=this.spCallback,window._sp_.config.mms_choice_selected_callback=this.spChoiceCallback,window._sp_.config.sp_script_blocked||o.register("sourcepoint",this.autoplay)};return t.prototype={autoplay:function(){return this.autoplayPromise},spCallback:function(e){if(e.msgID){var o=e.info||{},t=e.o||{},c=s.getNested(window.site_vars,"ADS","adblock_cookie");this.whitelist=t.wl?"whitelist-y":"whitelist-n",this.recovery=t.oir?"recovery-y":"recovery-n",this.msg_id=o.msg_id,this.cmpgn_id=o.cmpgn_id;var a=this.buildProp41()+"|impression";window.utag.link({clickName:a,clickPage:location.href,linkTrackVars:"prop41,prop64"}),window._sp_.displayed_message=!0,c&&i.cookie(c,!0,{expires:365})}else console.info("no message"),this.autoplayPromise.resolve()},spChoiceCallback:function(i){var e={1:"whitelist",2:"opt-in-recovery",3:"alt-ad"},s=e[i]||i;"whitelist"===s?this.whitelist="whitelist-y":"opt-in-recovery"===s&&(this.recovery="recovery-y");var o=this.buildProp41()+"|choice-"+s;window.utag.link({clickName:o,clickPage:location.href,linkTrackVars:"prop41,prop64"})},buildProp41:function(){return"adblockmessage|sp-"+this.cmpgn_id+"-"+this.msg_id+"|"+this.whitelist+"|"+this.recovery}},new t}});
//# sourceMappingURL=sourcepoint-utils.js.map