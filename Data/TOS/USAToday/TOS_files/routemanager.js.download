define(["jquery","underscore","state","managers/siteconfig","pubsub","utils","fwinfo"],function(t,e,n,a,i,o,r){"use strict";var s=function(){};return s.prototype={baseUrl:window.location.protocol+"//"+window.location.host,usatBetaDomain:"http://beta.usatoday.com",$canonical:t('link[rel="canonical"]'),start:function(t){this.started=!0,a.loadRoutes().done(e.bind(function(n){this.started&&(t&&o.get("win").on("popstate",e.bind(this._onStateChange,this)),this._onStateChange(),console.log("Site Loaded"))},this))},getLocalPath:function(t){if(!t||"#"===t)return null;if(t.indexOf(this.baseUrl))if(t.indexOf(this.usatBetaDomain)){if(-1!==t.indexOf("://"))return null}else t=t.substring(this.usatBetaDomain.length);else t=t.substring(this.baseUrl.length);return t},stop:function(){this.started=!1,o.get("win").off("popstate")},getInfo:function(e){var n=this.getLocalPath(e);return null!==n?a.getRouteInfo(t.trim(n)):null},isAjax:function(t){var e=this.getInfo(t);return e&&e.ajax},goTo:function(e,a,r){if(!o.isValidUrl(e)||!this._canNavigate())return!1;if(!n.getIntentUrl()&&this.isCurrentUrl(e))return console.warn("Tried navigating to the current url, skipping"),!1;i.trigger("track",{label:a,url:e,event:r}),t.ajax({url:"/comscorepvcandidate.xml",headers:{"Cache-Control":"no-cache, no-store, must-revalidate, private","Surrogate-Control":"max-age=0",Pragma:"no-cache",Expires:"0"},cache:!1});var s=this._goHashTag(e)||this._goInternal(e);return this.$canonical.attr("href",this.baseUrl+e),s||this._setLocation(this.attachChromeless(e)),delete window.simpleExclusion,delete window.simpleTarget,!0},goToInterstitual:function(t){return t=this.getLocalPath(t),Modernizr.history&&o.isValidUrl(t)&&this._canNavigate()&&this.getInfo(t)?(n.setIntentUrl(t),this._pushState(this.attachChromeless(t)),!0):!1},isCurrentUrl:function(t){var e=this.getLocalPath(t);return e&&(e=e.split("#")[0]),e===this._getCurrentPath()},_getCurrentPath:function(){return window.location.pathname+location.search},_setLocation:function(t){window.location.assign(t)},_canNavigate:function(){var t=n.getActivePageInfo().navigationWarning;return t&&!window.confirm(t)?!1:!0},_goHashTag:function(e){if("#"===e[0]){e=e.substring(1);var n=t("a[name="+e+"]").offset();return n&&n.top&&i.trigger("scrollTop",n.top-40),window.location.hash=e,!0}},attachChromeless:function(t){return window.chromeless?t+(-1===t.indexOf("?")?"?":"&")+"chromeless=true":t},_goInternal:function(t){return Modernizr.history&&this.isAjax(t)&&this.isAjax(o.getPageUrl())?(this._pushState(this.attachChromeless(this.getLocalPath(t))),this._onStateChange(),!0):!1},_pushState:function(t){window.history.pushState({},document.title,t)},_onStateChange:function(t){var e,a=window.location;a.pathname!==this._currentPathName&&("object"==typeof t&&(this.$canonical.attr("href",this.baseUrl+a.pathname),this._currentPathName&&r.setsessionvalue("clickPage",this.baseUrl+this._currentPathName)),this._currentPathName=a.pathname+a.search,e=this.getInfo(a.pathname),e?n.onRouteChange(e,a.pathname+a.search+a.hash):console.error("Could not find any site-config matching "+a.pathname))}},new s});
//# sourceMappingURL=routemanager.js.map