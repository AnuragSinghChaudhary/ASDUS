define(["jquery","underscore"],function(e,t){"use strict";var n=function(){this.storage={},this.set("DEBUG",!0),this.set("document",e(document)),this.set("win",e(window)),this.set("body",e("body")),this.set("scrollEl",e("html,body")),this.set("doc",e(document))};return n.prototype={set:function(e,t){this.storage[e]=t},get:function(e){return this.storage[e]},getPageUrl:function(){return this.getOrigin()+window.location.pathname},getOrigin:function(){return window.location.protocol+"//"+window.location.host},getPathname:function(){return window.location.pathname},getScrollPosition:function(){return window.pageYOffset||document.documentElement.scrollTop},parsePageInfo:function(e){return JSON.parse(e.find(".pageinfo").eq(0).html()||"{}")},_loadedScripts:{},loadScript:function(e,t,n){return this._loadedScripts[t]=this._loadedScripts[t]||this._requireScript(e,t),this._loadedScripts[t].done(n)},_requireScript:function(t,n){return e.Deferred(function(e){require([t],function(){var r=window[n];r?e.resolve(r):e.reject("Missing symbol: "+n+" from script: "+t)},e.reject)}).fail(function(e){console.error(e)})},openPopup:function(e,t,n){t=t||600,n=n||400;var r=this.popupCoords(t,n);window.open(e,"","menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height="+n+",width="+t+",top="+r.top+",left="+r.left)},isValidUrl:function(e){if(!e)return!1;if(-1!==e.indexOf("mailto:"))return!0;if(-1!==e.indexOf("javascript:"))return!1;if("#"===e[0]){if(1===e.length)return!1}else if(-1!==e.indexOf("../")||"/"!==e[0]&&-1===e.indexOf("://"))return console.error("Attempting to load a relative url, bad code monkey! ("+e+")"),!1;return!0},getNested:function(e,n){return e?(n=Array.prototype.slice.call(arguments,1),t.reduce(n,function(e,t){return e&&e[t]},e)):void 0},flag:function(e){return this.getNested(window.site_vars,"flags",e)},getSiteSections:function(){var e=this.getNested(window.site_vars,"sections")||"";return e?e.split("|"):[]},popupCoords:function(e,t){var n=window.screenLeft?window.screenLeft:window.screenX,r=window.screenTop?window.screenTop:window.screenY,i=window.outerWidth?window.outerWidth:document.documentElement.clientWidth,o=window.outerHeight?window.outerHeight:document.documentElement.clientHeight;return{left:n+i/2-e/2,top:r+o/2-t/2-25}},addCommas:function(e){e+="";for(var t=e.split("."),n=t[0],r=t.length>1?"."+t[1]:"",i=/(\d+)(\d{3})/;i.test(n);)n=n.replace(i,"$1,$2");return n+r},passiveSupported:function(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("test",null,t)}catch(n){}return e},lazyLoadImage:function(n,r,i,o,s){var a=!1,c="data-srcset";return r=r||"data-src",n.each(t.bind(function(t,n){var u=e(n),d=u.attr(r),l=u.attr("src"),f=u.attr(c),h=u.attr("srcset");d&&l!==d&&(this._attachHandler("error",u,o),this._attachHandler("load",u,s),u.attr("src",d),f&&h!==f&&u.attr("srcset",f),i||(u.removeAttr(r),f&&u.removeAttr(c)),a=!0)},this)),a},_attachHandler:function(e,t,n){var r=function(){t.off(e,r),"error"===e&&t.hide(),n&&n(t)};t.on(e,r)},getSectionPath:function(e){if(e&&(e=this._stripQueryParams(e)),e&&"/"!==e){"/"===e[0]&&(e=e.substring(1));var t=e.indexOf("/");return-1===t?e:e.substring(0,t)}return"home"},getSubSection:function(e){if(e){e=this._stripQueryParams(e),"/"!==e[e.length-1]&&(e+="/");var t=e.indexOf("/",1),n=e.indexOf("/",t+1);if(-1!==t&&-1!==n)return e.substring(t+1,n)}return""},_stripQueryParams:function(e){var t=e.indexOf("?");return-1!==t&&(e=e.substring(0,t)),e},lazyLoadError:function(t){e(this).hide(),t&&t(e(this))},requireSingleUseScript:function(n){return e.Deferred(function(e){require([n],function(t){e.resolveWith(this,[t])},function(t){console.error("failed loading scripts",t),e.reject(t)})}).always(t.bind(function(){this.removeRequireModule(n)},this)).promise()},removeRequireModule:function(t){require.undef(t),e('script[data-requiremodule="'+t+'"]').remove()},getUrlParam:function(e){var t=decodeURI((new RegExp(e+"=(.+?)(&|$)").exec(window.location.search)||[0,!1])[1]);return"false"===t?!1:"true"===t?!0:t},getSessionData:function(e,t){var n=sessionStorage[e];return n&&JSON.parse(n)||t},setSessionData:function(e,n){t.isString(n)||(n=JSON.stringify(n)),sessionStorage.setItem(e,n)},clearSessionData:function(e){sessionStorage.removeItem(e)},isDocumentHidden:function(){return document.hidden||document.webkitHidden||document.mozHidden||document.msHidden||document.oHidden},appendHashParams:function(e,n,r){if(n&&"string"==typeof e){var i=e.split("#"),o="",s=0;t.each(n,function(e,t){o+=(s>0?"&":"")+(r?r+"_":"")+t+"="+e,s++}),e=i[0]+"#"+o+(i[1]?"&"+i[1]:"")}return e},removeHashParamsByPrefix:function(e,t){if("string"==typeof e&&"string"==typeof t){for(var n=("#"===e[0]?e.substr(1):e).split("&"),r=n.length;r--;)n[r].substring(0,t.length)===t&&n.splice(r,1);return"#"+n.join("&")}return e},removeHashParamsFromCurrentUrl:function(e){if(window.location.hash.indexOf(e)){var t=this.removeHashParamsByPrefix(window.location.hash,e);t.length>1?window.location.hash=t:window.history&&window.history.replaceState&&history.replaceState("",document.title,window.location.pathname+window.location.search)}},isElementInViewport:function(t){t instanceof e&&(t=t[0]);var n=t.getBoundingClientRect(),r=window.innerHeight||document.documentElement.clientHeight,i=window.innerWidth||document.documentElement.clientWidth,o=n.top<=r&&n.top+n.height>=0&&n.left<=i&&n.left+n.width>=0;return n.left>=0&&n.top>=0&&n.left+n.width<=i&&n.top+n.height<=r?"full":o?"partial":"outside"},hasAutoplayVideo:function(e){return"video"===e.priority_asset||"video-asset"===e.basePageType||"SmallPlayerForPriorityVideo"===e["web-template"]||t.where(e.js_modules,{oembedprovider:"Inform, Inc."}).length},scrubEmail:function(e){var t=/(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))/gi;return String(e).replace(t,"")},checkForEmail:function(e){var t=/@/gi;return e.match(t)?!0:!1},logAction:function(e,t){try{window.newrelic.addPageAction(e,t)}catch(n){}}},new n});
//# sourceMappingURL=utils.js.map