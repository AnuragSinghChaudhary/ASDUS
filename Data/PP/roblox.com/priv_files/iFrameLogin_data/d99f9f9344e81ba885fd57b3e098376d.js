;// bundle: iframelogin___3418a67cb0c7cc3e43f564ba133fbbf8_m
;// files: jquery.ba-postmessage.min.js, Login/loginService.js, Login/iframe.js

;// jquery.ba-postmessage.min.js
/*
 * jQuery postMessage - v0.5 - 9/11/2009
 * http://benalman.com/projects/jquery-postmessage-plugin/
 * 
 * Copyright (c) 2009 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */
(function($){var g,d,j=1,a,b=this,f=!1,h="postMessage",e="addEventListener",c,i=b[h]&&!$.browser.opera;$[h]=function(k,l,m){if(!l){return}k=typeof k==="string"?k:$.param(k);m=m||parent;if(i){m[h](k,l.replace(/([^:]+:\/\/[^\/]+).*/,"$1"))}else{if(l){m.location=l.replace(/#.*$/,"")+"#"+(+new Date)+(j++)+"&"+k}}};$.receiveMessage=c=function(l,m,k){if(i){if(l){a&&c();a=function(n){if((typeof m==="string"&&n.origin!==m)||($.isFunction(m)&&m(n.origin)===f)){return f}l(n)}}if(b[e]){b[l?e:"removeEventListener"]("message",a,f)}else{b[l?"attachEvent":"detachEvent"]("onmessage",a)}}else{g&&clearInterval(g);g=null;if(l){k=typeof m==="number"?m:typeof k==="number"?k:100;g=setInterval(function(){var o=document.location.hash,n=/^#?\d+&/;if(o!==d&&n.test(o)){d=o;l({data:o.replace(n,"")})}},k)}}}})(jQuery);

;// Login/loginService.js
var Roblox=Roblox||{};Roblox.Login=Roblox.Login||{},Roblox.Login.service=Roblox.Login.service||function(){return{returnUrl:"/home",captchaRequired:!1,init:function(n){this.returnUrl=n||this.returnUrl,this.returnUrl=this.returnUrl.split("#")[0],this.returnUrl+=this.returnUrl.indexOf("?")>=0?"&nl=true":"?nl=true"},getLoginWithCaptchaUrl:function(n){return Roblox.Login.Resources.loginPageUrl+"?"+$.param({returnUrl:n||this.returnUrl,captcha:!0})},login:function(n,t,i){i=i||this.returnUrl;var r=$.Deferred();return typeof n!="string"||n.length<=0||typeof t!="string"||t.length<=0?(r.reject([Roblox.Login.Resources.errors.usernamePasswordRequired]),r.promise()):this.captchaRequired?(r.reject([Roblox.Login.Resources.errors.captchaRequired]),r.promise()):($.ajax({type:"POST",url:Roblox.Login.Resources.loginApiUrl,data:{username:n,password:t},crossDomain:!0,xhrFields:{withCredentials:!0},success:function(t){t&&t.tl?r.resolve({redirectUrl:Roblox.Login.Resources.twoStepVerificationPageUrl+"?"+$.param({tl:t.tl,username:n,returnUrl:i})}):r.resolve({redirectUrl:i})},error:function(n){n.responseJSON&&Array.isArray(n.responseJSON.errors)&&n.responseJSON.errors.length>0?r.reject(n.responseJSON.errors):r.reject([Roblox.Login.Resources.errors.unknown])}}),r.promise())}}}();

;// Login/iframe.js
var Roblox=Roblox||{};Roblox.Login=Roblox.Login||{},Roblox.Login.iframe=Roblox.Login.iframe||function(){function n(){function s(n){n?(r.hide(),e.show()):(r.show(),e.hide())}function t(n,t){u=!1,s(!1),n.parent().toggleClass("form-has-error",t)}function l(){var r=!1,u=[i,n];return Roblox.Login.service.captchaRequired&&u.push($("#recaptcha_response_field")),jQuery.each(u,function(){var n=$(this);n.val()===""?(t(n,!0),r=!0):t(n,!1)}),r}function h(){if(l())return!1;if(o)return t(n,!0),!1;u=!0,s(!0),Roblox.Login.service.login(n.val(),i.val()).done(function(n){window.parent.location=n.redirectUrl}).fail(function(n){switch(n[0].code){case 1:case 3:t(i,!0),$("#NotAMemberLink").hide(),$("#ForgotPasswordLink").show();break;case 2:default:window.parent.location=Roblox.Login.service.getLoginWithCaptchaUrl()}})}function a(){var i=n.val(),r=function(i){t(n,!i.success),o=!i.success,i.success||($("#NotAMemberLink").show(),$("#ForgotPasswordLink").hide())};i!==""&&$.ajax({type:"GET",url:"/UserCheck/doesusernameexist?username="+i,success:r,error:r})}var n=$("#UserName"),i=$("#Password"),f=$(document.body).data("parent-url"),r=$("#LoginButton"),e=$("#LoggingInStatus"),u=!1,o=!!n.val(),c="280px";Roblox.Login.service.captchaRequired=$(document.body).data("captchaon"),Roblox.Login.service.init(f),r.click(h),n.blur(a),$(document).keydown(function(n){if(n.which===13&&!u)return h(),!1}),$.postMessage("resize,"+c,f,parent)}return{init:n}}();
