(function(){define("modules/clean/account/account_photo_settings",["jquery","external/react","modules/clean/avatar/size","modules/clean/account_photo_modal/controller","modules/clean/ajax","modules/clean/avatar/faceholder","modules/clean/avatar/viewer_avatar","modules/clean/viewer","modules/clean/react/modal","modules/core/i18n","modules/core/notify"],function(e,t,o,n,r,s,i,a,l,u,c){var d,_,p,h,f,m,y,g;return f=o.VALID_AVATAR_DIMENSIONS,d=n.AccountPhotoModalController,h=l.SimpleModal,m=u._,g=t.DOM,y=t.createElement,p={PHOTO:"photo",NO_PHOTO:"no_photo"},_=t.createClass({displayName:"AccountPhotoSettings",propTypes:{"photo-url":t.PropTypes.string,dimension:t.PropTypes.oneOf(f).isRequired,"open-upload-account-photo-modal":t.PropTypes.bool.isRequired},getInitialState:function(){var e;return e=this.props["photo-url"]?p.PHOTO:p.NO_PHOTO,{mode:e}},componentDidMount:function(){if(e(document).on("db:account_photo:photo_set",(function(e){return function(t){return e.setState({mode:p.PHOTO})}})(this)),e(document).on("db:account_photo:photo_deleted",(function(e){return function(t){return e.setState({mode:p.NO_PHOTO})}})(this)),this.props["open-upload-account-photo-modal"])return d.show()},render:function(){return g.div({className:"account-photo-settings third-column"},g.h3({},m("Account photo")),y(i,{dimension:this.props.dimension,onPhotoClick:d.show,photoUrl:this.props["photo-url"],optionalClass:"avatar-component u-l-fl u-mar-right-s",defaultAvatar:y(s,{dimension:this.props.dimension,onClick:d.show,optionalClass:"avatar-component u-l-fl u-mar-right-s"})}),this.renderOptions())},renderOptions:function(){var e,t;return e="button-as-link account-photo-link",t=m(this.state.mode===p.PHOTO?"Change photo":"Add photo"),g.div({},g.button({className:e,onClick:this.openModalButtonClickHandler},t),this.state.mode===p.PHOTO?g.button({className:e,onClick:this.deleteButtonClickHandler},m("Delete photo")):void 0)},openModalButtonClickHandler:function(e){return e.preventDefault(),d.show()},deleteButtonClickHandler:function(t){return t.preventDefault(),h.show({title_text:m("Remove account photo"),body_html:m("Are you sure you want to remove your account photo?"),cancel_text:m("Cancel"),confirm_text:m("Remove"),confirm_callback:(function(t){return function(){return r.WebRequest({url:"/account/delete_account_photo",type:"POST",success:function(){return c.success(m("Account photo deleted"),3),e(document).trigger("db:account_photo:photo_deleted")},error:function(){return c.error(m("There was a problem deleting your account photo"),3)}})}})(this)})}}),{AccountPhotoSettings:_}})}).call(this),function(){define("modules/clean/account/security_keys",["external/classnames","external/mcl/icon_admin","external/react","external/underscore","jquery","modules/clean/ajax","modules/clean/react/modal","modules/clean/react/sprite","modules/clean/react/tooltip","modules/clean/viewer","modules/core/i18n","modules/core/notify"],function(e,t,o,n,r,s,i,a,l,u,c,d){var _,p,h,f,m,y,g,b,v,w,k;return p=t.IconAdmin,h=i.Modal,y=i.SimpleModal,g=c._,w=c.ungettext,v=o.DOM,b=o.createElement,k=u.get_viewer(),_="disable-seckey-modal-root",f=o.createClass({displayName:"SecurityKeyManager",propTypes:{initialKeys:o.PropTypes.arrayOf(o.PropTypes.object),userId:o.PropTypes.number,teamId:o.PropTypes.number,useMclIcon:o.PropTypes.bool},getInitialState:function(){return{keys:this.props.initialKeys}},addKey:function(){return h.close(),r(document).trigger("twofactor:ADD_SECURITY_KEY",this.props.userId)},disableKey:function(e){var t,o;if(this.isAdmin?t="/account/team/twofactor/u2f_disable_device":(t="/account/twofactor/u2f_disable_device",o=this.props.userId),y.show({title_text:g("Disable security key?"),body_html:g("Are you sure you want to disable this security key?"),confirm_text:g("Disable"),cancel_text:g("Cancel"),autoclose:!this.isAdmin,confirm_callback:(function(i){return function(){return new s.WebRequest({url:t,subject_user:o,data:{user_id:i.props.userId,team_id:i.props.teamId,u2f_gid:e.gid,checkpoint_token:i.checkpoint_token},success:function(t){return i.isAdmin||i.setState({keys:n.without(i.state.keys,e)}),d.success(g("Successfully disabled security key.")),h.close(_)},error:function(e){switch(e.responseText){case"err:EXPIRED":return h.hide(_),r(document).trigger("security-key-modal:ASK_PASSWORD_CONFIRM",this.props.userId);default:return d.error(g("There was a problem disabling your security key."))}}})}})(this)},_),!this.isAdmin&&null==this.checkpoint_token)return h.hide(_),r(document).trigger("twofactor:ASK_PASSWORD_CONFIRM",this.props.userId)},manageKeys:function(){return h.showInstance(b(m,{addKeyHandler:this.addKey,communicateCheckpointToken:this.sendCheckpointToken,disableKeyHandler:this.disableKey,keys:this.state.keys,userId:this.props.userId,teamId:this.props.teamId}))},sendCheckpointToken:function(e){return this.checkpoint_token=e},keysLabel:function(){return w("%(num)s key","%(num)s keys",this.state.keys.length).format({num:this.state.keys.length})},fetchKeyInfo:function(){return new s.WebRequest({url:"/account/twofactor/security_keys/",success:(function(e){return function(t){return e.setState({keys:JSON.parse(t)})}})(this),subject_user:this.props.userId})},fetchKeyInfoTeam:function(){return new s.WebRequest({url:"/account/team/twofactor/security_keys/",data:{user_id:this.props.userId,team_id:this.props.teamId},success:(function(e){return function(t){return e.setState({keys:JSON.parse(t)})}})(this)})},componentWillMount:function(){if(this.isAdmin=null!=this.props.teamId,!this.isAdmin)return this.user=k.get_user_by_id(this.props.userId)},componentDidMount:function(){return r(document).on("security-key-manager:UPDATE_KEYS",(function(e){return function(t,o){return e.isAdmin?e.fetchKeyInfoTeam():e.user.id===o?e.fetchKeyInfo():void 0}})(this)),this.isAdmin?this.fetchKeyInfoTeam():this.fetchKeyInfo()},renderAdminActionDescription:function(){return this.props.useMclIcon?v.div({className:"action_list_button_content"},v.span({className:"action_list_button_icon_wrapper"},b(p,{name:"greyscale-manage-security-keys"})),v.span({className:"action_list_icon_text"},g("Manage security keys"))):v.div({},b(a,{group:"teams",name:"actions_seckey",className:"icon_no_hover",alt:""}),g("Manage security keys"))},render:function(){var t;return t=this.state.keys.length>0,this.isAdmin?v.a({className:e({action_list_button_content_wrapper:this.props.useMclIcon}),href:"#",onClick:this.manageKeys},this.renderAdminActionDescription()):v.div({className:"manage-twofactor-security-keys"},v.span({hidden:!0,className:"update",onClick:this.fetchKeyInfo}),v.span({hidden:!t},this.keysLabel()+" ",v.a({className:"edit-link",onClick:this.manageKeys},g("Edit"))),v.span({hidden:t},v.a({className:"add-link",onClick:this.addKey},g("Add"))))}}),m=o.createClass({displayName:"SecurityKeyModal",propTypes:{addKeyHandler:o.PropTypes.func,communicateCheckpointToken:o.PropTypes.func,disableKeyHandler:o.PropTypes.func,keys:o.PropTypes.arrayOf(o.PropTypes.object),userId:o.PropTypes.number,teamId:o.PropTypes.number},componentWillMount:function(){if(this.isAdmin=null!=this.props.teamId,!this.isAdmin)return this.user=k.get_user_by_id(this.props.userId)},componentDidMount:function(){return r(document).on("security-key-modal:PASSWORD_CONFIRMED",(function(e){return function(t,o,n){if(e.props.userId===o)return e.checkpoint_token=n,e.props.communicateCheckpointToken(n),h.unhide(_)}})(this))},disableKey:function(e){return this.props.disableKeyHandler(e)},renderTooltipContents:function(e){return v.span({},v.p({style:{fontWeight:"bold"}},g("Signed In")),v.p({},e.ts_tz,v.br({}),e.country,v.br({}),e.device))},renderKeyRows:function(){return this.props.keys.map((function(e){return function(t){return v.li({className:"key_row"},v.span({className:"last_used_info"},g("Last used")+" "+t.last_used.ts_ago,v.span," • "+t.last_used.country+" ",b(l.Tooltip,{position:l.TooltipPosition.RIGHT,tooltip_contents:e.renderTooltipContents(t.last_used)},b(a,{group:"web",name:"info",alt:""}))),v.span({className:"added_info",title:t.created.ts_tz},g("Added")+" "+t.created.ts_ago),v.span({className:"disable_key",onClick:function(){return e.disableKey(t)}},b(a,{group:"web",name:"xclose",alt:""})))}})(this))},render:function(){var e,t;return this.user&&(t=k.get_title_by_role(this.user.role)),e=t?" • "+t:"",b(h,{title:g("Security Keys")+e,buttonComponent:v.div({className:"db-modal-buttons"},v.button({className:"dbmodal-button button-tertiary",onClick:this.props.addKeyHandler,style:{float:"left",marginLeft:0}},g("Add new key")),v.button({className:"dbmodal-button button-primary",onClick:function(){return h.close()}},g("Done"))),width:680},v.div({className:"twofactor-security-keys-edit-modal"},v.p({},g(this.isAdmin?"Security keys are a secure method to complete Dropbox two-step verification.":"Security keys help you complete two-step verification when logging into Dropbox.")),v.div({className:"twofactor-security-keys-container"},v.ul({id:"key-rows"},this.renderKeyRows()))))}}),{SecurityKeyManager:f}})}.call(this),function(){define("modules/clean/account/security_tab",["jquery","modules/clean/account/password_change"],function(e,t){return(function(){function o(){e(".show-change-password").on("click",function(o){var n;return o.preventDefault(),n=e(o.target).data("uid"),new t(n).show()})}return o})()})}.call(this),define("modules/clean/account_photo_modal/controller",["require","exports","tslib","dropins_sdk_v2","modules/clean/account_photo_modal/ui","modules/clean/analytics","modules/clean/photo_upload/controller","modules/constants/dropins","modules/core/i18n","modules/core/uri"],function(e,t,o,n,r,s,i,a,l,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.init({appKey:a.CHOOSER_APP_KEY});var c={DEFAULT:l._("There was an error uploading your photo."),SIZE_TOO_LARGE:l._("Your photo should be no more than 10 MB in size."),DIMENSIONS_TOO_SMALL:l._("Your photo should be at least 128px by 128px."),INVALID:l._("We couldn’t process your photo."),MULTIPLE_FILES:l._("You selected multiple files. Your photo should be a single file."),UNSUPPORTED_EXTENSION:l._("This file type isn’t supported. For best results, select a PNG or JPG file.")},d=(function(){function e(){}return e.prototype.on_show=function(){s.UserActivityLogger.log("web","account_photo_modal_shown")},e.prototype.on_start_over=function(){s.UserActivityLogger.log("web","account_photo_modal_start_over")},e.prototype.on_save=function(){s.UserActivityLogger.log("web","account_photo_modal_save")},e.prototype.on_error=function(e){s.UserActivityLogger.log("web","account_photo_modal_error",e)},e.prototype.on_photo_selected=function(e){s.UserActivityLogger.log("web","account_photo_modal_photo_selected",e)},e.prototype.on_button_clicked=function(e){s.UserActivityLogger.log("web","account_photo_modal_button_clicked",e)},e.prototype.on_file_dropped=function(){s.UserActivityLogger.log("web","account_photo_modal_file_dropped")},e})(),_=(function(e){function t(){return e.call(this,new d,"account_photo","/account/set_account_photo","/account/delete_account_photo",c)||this}return o.__extends(t,e),t.show=function(){(new t).show(r.AccountPhotoModalUI)},t.prototype._update_photo_url=function(e){return u.parse(e).updateQuery({size:"128x128"}).toString()},t})(i);t.AccountPhotoModalController=_}),define("modules/clean/account_photo_modal/mode_enum",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AccountPhotoModalMode={SELECT:"select",ERROR:"error",UPLOADING:"uploading",CONFIRM:"confirm"}}),define("modules/clean/account_photo_modal/ui",["require","exports","tslib","external/react","modules/clean/account_photo_modal/mode_enum","modules/clean/photo_upload/ui","modules/clean/react/css","modules/clean/react/modal","modules/core/i18n"],function(e,t,o,n,r,s,i,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=i(s,["/static/css/account_photo_modal-vflg44N5X.css"]),c=l._("Select an account photo so your friends and coworkers can recognize you around Dropbox."),d=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={mode:r.AccountPhotoModalMode.SELECT,error_message:null,percent_uploaded:null,large_photo_url:null,dragover:!1},t.closeModal=function(){t.refs.modal.close()},t}return o.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.dismiss_handler,o=e.on_mount,r=e.upload_button_id,s=e.upload_container_id,i=e.chooser_button_click_handler,d=e.start_over_button_click_handler,_=e.save_button_click_handler,p=this.state,h=p.mode,f=p.large_photo_url,m=p.dragover,y=p.error_message,g=p.percent_uploaded;return n.createElement(a.Modal,{acceptButtonText:null,onDismiss:t,ref:"modal",style:"clean",width:500},n.createElement("div",{className:"add-account-photo-modal"},n.createElement(u,{mode:h,reason_to_upload:c,on_confirm_text:n.createElement("span",null,n.createElement("strong",null,l._("Looking good!"))," ",l._("Your account photo has been set.")),on_mount:o,upload_button_id:r,upload_container_id:s,chooser_button_click_handler:i,start_over_button_click_handler:d,save_button_click_handler:_,on_finish:this.closeModal,large_photo_url:f,dragover:m,error_message:y,percent_uploaded:g,can_choose_from_dropbox:!0,display_photo_on_select:!1,class_name:""})))},t})(n.Component);t.AccountPhotoModalUI=d}),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};define("modules/clean/legacy_pyxl_controllers/db_select",["jquery","modules/core/controller_helpers"],function(t,o){return(function(){function n(o){this.$select_container=o,this._setup_valhooks=e(this._setup_valhooks,this),this.on_option_click=e(this.on_option_click,this),this.$select_elm=this.$select_container.find(".db-select"),this.$select_elm.on("mousedown",(function(e){return function(){return e.toggle_dropdown(),!1}})(this)),this.$select_elm.on("focus",(function(e){return function(){return e.show_dropdown(),!1}})(this)),this.$select_elm.on("blur",(function(e){return function(){return e.hide_dropdown(),!1}})(this)),this.$select_elm.click((function(e){return function(e){return!1}})(this)),t(document).click((function(e){return function(t){return e.hide_dropdown()}})(this)),this.$select_elm.css("background-image",this.background_image),this._setup_valhooks()}return n.prototype.background_image="url('/static/images/downarrow_gray-vfldLgMOB.png')",n.prototype.on_option_click=function(e){var o,n,r;return n=t(e.target),r=n.data("val"),o=n.data("index"),n.hasClass("disabled")?(this.$select_elm.trigger("disabled-option-clicked",r),!1):this.$select_elm.prop("selectedIndex",o).change()},n.prototype.toggle_dropdown=function(){return null!=this.dropdown?this.hide_dropdown():this.show_dropdown()},n.prototype.show_dropdown=function(){var e,o,n,r,s,i,a;if(!this.dropdown){for(this.$select_elm.addClass("dropdown"),a=t("<ul class='db-select-list' />"),i=this.$select_elm.find("option"),o=e=0,n=i.length;e<n;o=++e)s=i[o],s=t(s),r=t("<li/>").text(s.data("dropdown-label")||s.text()),r.data("val",s.val()),r.data("index",o),s.hasClass("disabled")&&r.addClass("disabled"),r.click(this.on_option_click),a.append(r);return this._generate_dropdown_from_ul(a)}},n.prototype._generate_dropdown_from_ul=function(e){var t;return this.dropdown=e.appendTo(this.$select_elm.parent()),this.dropdown.width(this.$select_elm.innerWidth()),t=this.$select_elm.offset(),t.top+=this.$select_elm.innerHeight()+1,this.dropdown.offset(t)},n.prototype.hide_dropdown=function(){if(this.dropdown)return this.$select_elm.removeClass("dropdown"),this.dropdown.remove(),delete this.dropdown},n.prototype.enable=function(e){var t;return t=this.$select_elm.find("option[value="+e+"]"),t.removeClass("disabled")},n.prototype.disable=function(e){var t;return t=this.$select_elm.find("option[value="+e+"]"),t.addClass("disabled")},n.prototype._setup_valhooks=function(){return this.$select_container.each(function(){return this.type="dbselect"}),t.valHooks.dbselect={get:(function(e){return function(e){return t(e).find("select").val()}})(this),set:(function(e){return function(e,n){return o.get_controller(t(e))._set_value(n)}})(this)}},n})()})}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};define("modules/clean/legacy_pyxl_controllers/phone_number",["jquery","external/phone_helpers","external/underscore","modules/core/controller_helpers","modules/core/i18n","modules/clean/legacy_pyxl_controllers/select_input"],function(t,o,n,r,s,i){var a;return a=s._,(function(){function o(t){this.$phone_input=t,this._setup_valhooks=e(this._setup_valhooks,this),this.set=e(this.set,this),this.$error_span=null,this.id=this.$phone_input.attr("id"),this.$country_select=this.$phone_input.find(".phone-country"),this.$phone_text=this.$phone_input.find(".phone-text"),this._setup_valhooks(),this._listen()}return o.prototype._listen=function(){return this._reformat(),this.$phone_text.on("blur",(function(e){return function(){return e._reformat(),e.validate_on_blur()}})(this)),this.$country_select.on("change",(function(e){return function(){return e._reformat(),e.validate_on_blur()}})(this)),this.$phone_text.on("focus",(function(e){return function(){return e.hide_error()}})(this))},o.prototype._reformat=function(){var e,o,n;return this.hide_error(),(n=this.$phone_text.val())?(o=phone_helpers.format(this.get_country_code(),n),o?this.$phone_text.val(o):void 0):(e=phone_helpers.get_example_mobile_number(this.get_country_code()),void t("label",this.$phone_text).text(a("Example: ")+e))},o.prototype.get_country_code=function(){return phone_helpers.iso_to_dialing(this.$country_select.val()||"US")},o.prototype.get_local_number=function(){var e,t;return e=this.$phone_input.val(),t=phone_helpers.split_number(e),t.phone_number},o.prototype.is_empty=function(){return!this.$phone_text.val()},o.prototype.show_error=function(e){var t;return t=this.$phone_input.find(".phone-number-error"),t.css("display","block"),t.text(e)},o.prototype.hide_error=function(){var e;return e=this.$phone_input.find(".phone-number-error"),e.html("&nbsp;")},o.prototype.is_valid_french_polynesian_number=function(e){return"+689"===e.slice(0,4)&&(e=e.slice(4),e=e.replace(/[^\d]/g,""),6===e.length||8===e.length)},o.prototype.validate_on_blur=function(){var e;return this.is_empty()?(this.hide_error(),!0):(e=this.$phone_input.val(),this.is_valid_french_polynesian_number(e)?(this.hide_error,!0):phone_helpers.is_valid(e)?(this.hide_error(),!0):(this.show_error(a("Invalid phone number")),!1))},o.prototype.validate_on_submit=function(){return!!this.validate_on_blur()&&(!this.is_empty()||(this.show_error(a("Please enter a phone number")),!1))},o.prototype.focus=function(){return this.$phone_text.focus()},o.prototype.get=function(){if(this.is_empty())return null;try{return phone_helpers.full_number(this.$country_select.val(),this.$phone_text.val())}catch(e){return e,null}},o.prototype.set=function(e){var t;if(!e)return this.$phone_text.val(""),void this._reformat();try{t=phone_helpers.split_number(e),t.iso_code&&(this.$country_select.val(t.iso_code),this.$phone_text.val(phone_helpers.format(t.dialing_code,t.phone_number)),this._reformat())}catch(t){return t,this.$phone_text.val(e),this.show_error(a("Invalid phone number"))}},o.prototype._setup_valhooks=function(){return this.$phone_input.each(function(){return this.type="phoneinput"}),t.valHooks.phoneinput={get:function(e){return r.get_controller(t(e)).get()},set:function(e,o){return r.get_controller(t(e)).set(o)}}},o.prototype._validate_phone_number=function(e,t){return t=t.replace(/\D/g,""),e+" "+t,phone_helpers.format(e,t)},o})()})}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function n(){this.constructor=e}for(var r in t)o.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},o={}.hasOwnProperty;define("modules/clean/legacy_pyxl_controllers/select_input",["jquery","external/underscore","modules/core/controller_helpers","modules/clean/accessibility/tabbable","modules/clean/keycode"],function(o,n,r,s,i){var a,l;return l=i.KeyCode,a=function(e){return"string"==typeof e?e.toLowerCase():o(e).text().toLowerCase()},(function(s){function i(t){this.$select_input=t,this._setup_valhooks=e(this._setup_valhooks,this),this._unfocus_options=e(this._unfocus_options,this),this._get_next=e(this._get_next,this),this._get_prev=e(this._get_prev,this),this.$dropdown=this.$select_input.find(".select-input-dropdown"),this.$select=this.$select_input.find("select"),this.$input_label=this.$select_input.find(".select-input-input"),this.$options=this.$dropdown.find(".select-option"),this.$sorted_options=n.sortBy(this.$options.not(".select-option-disabled"),a),this.mouse_input=!0,this._listen(),this._setup_valhooks(),i.__super__.constructor.call(this)}return t(i,s),i.DISABLED_OPTION_CLICKED="db:select_input:disabled_option_clicked",i.prototype.dropdown_shown=!1,i.prototype.$focused_option=null,i.prototype._keyboard_select_prefix="",i.prototype._keyboard_select_timeout=null,i.prototype.toggle_dropdown=function(){return this.dropdown_shown?this.hide_dropdown():this.show_dropdown()},i.prototype._scroll_to_include=function(e){var t,o,n,r;return r=this.$dropdown.scrollTop(),n=r+this.$dropdown.height(),o=e.position().top+r,t=o+e.height(),o<r?this.$dropdown.scrollTop(o):t>n?this.$dropdown.scrollTop(t-this.$dropdown.height()):void 0},i.prototype._set_focused_option=function(e){if(e.length)return this.$focused_option&&this._unfocus_options(),this.$focused_option=e,this.$focused_option.addClass("focused-option"),this._scroll_to_include(this.$focused_option)},i.prototype._common_prefix_len=function(e,t){var n;for(e=o.trim(e).toLowerCase(),t=o.trim(t).toLowerCase(),n=0;n<e.length&&n<t.length&&e.charAt(n)===t.charAt(n);)n++;return n},i.prototype._pick_option_alphabetically=function(e){var t,r,s,i,l;return l=n.sortedIndex(this.$sorted_options,e,a),r=o(this.$sorted_options[Math.max(l-1,0)]),t=o(this.$sorted_options[Math.min(l,this.$sorted_options.length-1)]),i=this._common_prefix_len(e,r.text()),s=this._common_prefix_len(e,t.text()),i>=s?r:t},i.prototype.show_dropdown=function(){var e;if(!this.$select_input.hasClass("select-input-disabled"))return this.$select_input.addClass("select-input-dropdown-shown"),e=this.$select_input.val(),this._set_focused_option(this.$options.closest('[data-value="'+e+'"]').first()),this.dropdown_shown=!0},i.prototype.hide_dropdown=function(){return this.$select_input.removeClass("select-input-dropdown-shown"),this.dropdown_shown=!1,this._unfocus_options(),this.$focused_option=null},i.prototype._listen=function(){var e,t;return this.$select_input.hasClass("select-input-disabled")||this.$input_label.click((function(e){return function(){return e.toggle_dropdown()}})(this)),o(document).click((function(e){return function(t){var n;if(e.dropdown_shown&&(n=o(t.target).closest(".select-input-input"),!n.length||n[0]!==e.$input_label[0]))return e.hide_dropdown()}})(this)),this.$options.click((function(e){return function(t){var n;return n=o(t.target).closest(".select-option"),n.hasClass("select-option-disabled")?(e.$select_input.trigger(i.DISABLED_OPTION_CLICKED),!1):e._set_value(n.data("value"),n)}})(this)),this.$input_label.on("keydown",(function(e){return function(t){var o;if(e.mouse_input=!1,t.keyCode===l.TAB)return e.hide_dropdown(),!0;if(t.keyCode===l.ESC)return e.hide_dropdown();if(t.keyCode===l.ENTER){if(e.dropdown_shown&&e.$focused_option)return e._set_value(e.$focused_option.data("value"),e.$focused_option),e.hide_dropdown()}else{if(t.keyCode===l.UP||t.keyCode===l.DOWN)return e.dropdown_shown&&e.$focused_option?t.keyCode===l.UP&&e._get_prev(e.$focused_option).length?e._set_focused_option(e._get_prev(e.$focused_option)):t.keyCode===l.DOWN&&e._get_next(e.$focused_option).length&&e._set_focused_option(e._get_next(e.$focused_option)):e.show_dropdown(),!1;if(!n.contains(n.values(l),t.keyCode)&&(o=String.fromCharCode(t.which),e._keyboard_select_prefix=e._keyboard_select_prefix+o,e._set_focused_option(e._pick_option_alphabetically(e._keyboard_select_prefix)),e._keyboard_select_timeout&&clearTimeout(e._keyboard_select_timeout),e._keyboard_select_timeout=setTimeout(function(){return e._keyboard_select_prefix="",e._keyboard_select_timeout=null},500)," "===o))return!1}}})(this)),e=null,t=null,this.$dropdown.mousemove((function(o){return function(n){return n.pageX===e&&n.pageY===t||(o.mouse_input=!0),e=n.pageX,t=n.pageY}})(this)),this.$options.hover((function(e){return function(t){if(e.mouse_input)return e._set_focused_option(o(t.currentTarget))}})(this))},i.prototype._get_prev=function(e){return e.prev(":not(.select-option-disabled)")},i.prototype._get_next=function(e){return e.next(":not(.select-option-disabled)")},i.prototype._unfocus_options=function(){return this.$options.removeClass("focused-option")},i.prototype._setup_valhooks=function(){return this.$select_input.each(function(){return this.type="selectinput"}),o.valHooks.selectinput={get:(function(e){return function(e){return o(e).find("select").val()}})(this),set:(function(e){return function(e,t){return r.get_controller(o(e))._set_value(t)}})(this)}},i.prototype._set_value=function(e,t){if(t||(this.$select.val(e),t=this.$options.not(".select-option-disabled").closest('[data-value="'+e+'"]').first()),t.length)return this.$input_label.find(".select-option").remove(),this._unfocus_options(),this.$input_label.prepend(r.clone_element(t)),this.$select.val(e),this.$select_input.trigger("change")},i})(s)})}.call(this),function(){define("modules/clean/legacy_pyxl_controllers/tabs",["jquery","modules/core/controller_helpers","modules/clean/keycode"],function(e,t,o){var n;return n=o.KeyCode,(function(){function o(o){var n,r,s,i;this.container=o,t.deprecated_set_controller(this.container,this),this.tabs=this.container.children(".c-tabs__bar").find(".c-tabs__tab .c-tabs__label[role='tab']"),this._listen(),e(window).trigger("hashchange"),this.container.hasClass("c-tabs--center")||(n=this.container.innerWidth(),s=function(){var t,o,n,s;for(n=this.tabs,s=[],t=0,o=n.length;t<o;t++)r=n[t],s.push(e(r).outerWidth());return s}.call(this).reduce(function(e,t){return e+t},0),s>.8*n&&(i=(n-s)/(this.tabs.length+1),this.tabs.css("width","+="+i)))}return o.TAB_SHOWN="tabs:tab_shown",o.get_tabs=function(o){return t.get_controller(e("#"+o))},o.prototype._listen=function(){var t;e(window).bind("hashchange",(function(t){return function(){var o,n,r,s,i,a,l,u;return r=window.location.hash.split("#")[1],a=t.container.find("[data-hash-prefix]"),i=function(t){var o;return o=e(t).data("hash-prefix"),0===(null!=r?r.indexOf(o):void 0)},s=(function(){var e,t,o;for(o=[],e=0,t=a.length;e<t;e++)l=a[e],i(l)&&o.push(l);return o})(),s.length>0?(o=e(s[0]),u=t.container.find("#"+o.data("id")).is(":visible"),t._show_tab(o,!1),n=(function(){try{return e(window.location.hash)}catch(e){return[]}})(),!u&&n.length?n[0].scrollIntoView():void 0):t._show_tab(t.container.find("[data-hash="+r+"]"),!1)}})(this)),t=this.container.children(".c-tabs__bar").find(".c-tabs__tab .c-tabs__label[role='tab']"),t.click((function(t){return function(o){var n,r;return n=e(o.currentTarget),r=n.data("hash")||window.location.hash,window.location.hash!==r&&(window.location.hash=r),t._show_tab(n,!0),!1}})(this)),t.keydown((function(o){return function(r){var s,i,a,l,u;return s=e(r.currentTarget),i=o.tabs.index(s),(l=r.keyCode)===n.LEFT||l===n.UP?(a=e(0===i?o.tabs[o.tabs.length-1]:o.tabs[i-1]),o._show_tab(a,!0),!1):(u=r.keyCode)===n.RIGHT||u===n.DOWN?(a=e(i===t.length-1?t[0]:t[i+1]),o._show_tab(a,!0),!1):void 0}})(this)),t.attr("data-initialized",!0)},o.prototype._show_tab=function(e,t){var n;if(e.length)return n=this.container.children(".c-tabs__bar").children(".c-tabs__tab"),n.removeClass("c-tabs__tab--selected"),n.children("[role='tab']").attr("tabindex","-1").attr("aria-selected","false"),this.container.children(".c-tabs__content").removeClass("c-tabs__content--selected"),e.attr("tabindex","0").attr("aria-selected","true"),e.parent().addClass("c-tabs__tab--selected"),this.container.find("#"+e.data("id")).addClass("c-tabs__content--selected"),this.container.trigger(o.TAB_SHOWN,e),t?e.focus():void 0},o.prototype.show_tab=function(e){return this._show_tab(this.container.children(".c-tabs__bar").find(".c-tabs__tab [data-id="+e+"]")(!1))},o})()})}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=[].indexOf||function(e){for(var t=0,o=this.length;t<o;t++)if(t in this&&this[t]===e)return t;return-1};define("modules/clean/photo_upload/controller",["jquery","external/underscore","external/plupload_dev","external/react","modules/clean/photo_upload/mode_enum","modules/clean/analytics","modules/clean/ajax","modules/clean/react/modal","modules/clean/viewer","modules/core/cookies","modules/core/i18n"],function(o,n,r,s,i,a,l,u,c,d,_){var p;return a.UserActivityLogger,p=u.Modal,_._,(function(){function r(t,o,n,r,s){this.logger=t,this.uploader_name=o,this.choose_from_dropbox_url=n,this.delete_url=r,this.error_messages=s,this._enable_drag_drop_beyond_dropzone=e(this._enable_drag_drop_beyond_dropzone,this),this._disable_drag_drop_beyond_dropzone=e(this._disable_drag_drop_beyond_dropzone,this),this._show_photo_preview=e(this._show_photo_preview,this),this._show_error=e(this._show_error,this),this._show_loading=e(this._show_loading,this),this.save_button_click_handler=e(this.save_button_click_handler,this),this.file_uploaded_handler=e(this.file_uploaded_handler,this),this.error_handler=e(this.error_handler,this),this.drag_and_drop_handler=e(this.drag_and_drop_handler,this),this.upload_button_click_handler=e(this.upload_button_click_handler,this),this.upload_progress_handler=e(this.upload_progress_handler,this),this.files_added_handler=e(this.files_added_handler,this),this.post_init_handler=e(this.post_init_handler,this),this.start_over_button_click_handler=e(this.start_over_button_click_handler,this),this.chooser_button_click_handler=e(this.chooser_button_click_handler,this),this.show=e(this.show,this),this.upload_button_id=this.uploader_name+"-upload-button",this.upload_container_id=this.uploader_name+"-upload-container"}return r.prototype.PHOTO_SOURCE={UPLOADER:"uploader",CHOOSER:"chooser"},r.prototype.VALID_MIME_TYPES=["image/png","image/jpeg","image/tiff"],r.prototype.show=function(e,t){var o,r;return r={on_mount:(function(e){return function(){return e._init_uploader()}})(this),upload_button_id:this.upload_button_id,upload_container_id:this.upload_container_id,chooser_button_click_handler:this.chooser_button_click_handler,save_button_click_handler:this.save_button_click_handler,start_over_button_click_handler:this.start_over_button_click_handler,dismiss_handler:this._enable_drag_drop_beyond_dropzone},n.extend(r,t),this.modal=p.showInstance(s.createElement(e,r)),"function"==typeof(o=this.logger).on_show?o.on_show():void 0},r.prototype.chooser_button_click_handler=function(e){var t,o;return"function"==typeof(t=this.logger).on_button_clicked&&t.on_button_clicked({source:this.PHOTO_SOURCE.CHOOSER}),o={success:(function(e){return function(t){return e._show_loading(),l.WebRequest({url:e.choose_from_dropbox_url,type:"POST",data:{selected_file:t[0].link},success:function(t){return e._show_photo_preview(t,e.PHOTO_SOURCE.CHOOSER)}})}})(this),linkType:"direct",multiselect:!1,extensions:["images"]},Dropbox.choose(o)},r.prototype.start_over_button_click_handler=function(e){var t;return this.uploader.disableBrowse(!1),this.modal.setState({mode:i.SELECT}),l.WebRequest({url:this.delete_url,type:"POST",success:function(){},error:function(){return!1},timeout:function(){}}),o(document).trigger("db:"+this.uploader_name+":photo_deleted"),"function"==typeof(t=this.logger).on_start_over?t.on_start_over():void 0},r.prototype.post_init_handler=function(e,t){var n;return n=o("#"+this.upload_button_id),n.on("dragenter",(function(e){return function(t){if(!e._uploader_browse_button_disabled())return e.modal.setState({dragover:!0})}})(this)),
n.on("dragleave drop",(function(e){return function(t){return e.modal.setState({dragover:!1})}})(this)),this._disable_drag_drop_beyond_dropzone()},r.prototype.files_added_handler=function(e,o){var n,r,s,i,a,l,u,c,_;if(l=this.PHOTO_SOURCE.UPLOADER,this._uploader_browse_button_disabled()){for(c=[],r=0,i=o.length;r<i;r++)n=o[r],c.push(this.uploader.removeFile(n));return c}if(o.length>1){for(this._show_error(this.error_messages.MULTIPLE_FILES,l),_=[],s=0,a=o.length;s<a;s++)n=o[s],_.push(this.uploader.removeFile(n));return _}return n=o[0],n.origSize>10*Math.pow(1024,2)?(this._show_error(this.error_messages.SIZE_TOO_LARGE,l),this.uploader.removeFile(n)):(u=n.type,t.call(this.VALID_MIME_TYPES,u)<0?(this._show_error(this.error_messages.UNSUPPORTED_EXTENSION,l),this.uploader.removeFile(n)):(this._show_loading("0"),this.uploader.settings.multipart_params.t=d.read("__Host-js_csrf"),this.uploader.start()))},r.prototype.upload_progress_handler=function(e,t){return this._show_loading(t.percent)},r.prototype.upload_button_click_handler=function(e){var t;return"function"==typeof(t=this.logger).on_button_clicked?t.on_button_clicked({source:this.PHOTO_SOURCE.UPLOADER}):void 0},r.prototype.drag_and_drop_handler=function(e){var t;return"function"==typeof(t=this.logger).on_file_dropped?t.on_file_dropped():void 0},r.prototype.error_handler=function(e,t){return this._show_error(this.error_messages.DEFAULT,this.PHOTO_SOURCE.UPLOADER)},r.prototype.file_uploaded_handler=function(e,t,o){var n,r;return r=JSON.parse(o.response),n=this.PHOTO_SOURCE.UPLOADER,null!=r.error_token&&r.error_token in this.error_messages?this._show_error(this.error_messages[r.error_token],n):null!=r.photo_url?this._show_photo_preview(r.photo_url,n):this._show_error(this.error_messages.DEFAULT,n)},r.prototype.save_button_click_handler=function(){var e;return o(document).trigger("db:"+this.uploader_name+":flow_completed"),this._enable_drag_drop_beyond_dropzone(),"function"==typeof(e=this.logger).on_save?e.on_save():void 0},r.prototype._init_uploader=function(){var e,t;return e={t:d.read("__Host-js_csrf"),is_xhr:!0},e._subject_uid=c.get_viewer().get_users()[0].id,t={browse_button:this.upload_button_id,drop_element:this.upload_button_id,container:this.upload_container_id,url:"https://dl-web.dropbox.com/upload_"+this.uploader_name,file_data_name:"file",multipart_params:e,runtimes:this.runtime,flash_swf_url:void 0,multi_selection:!1,init:{Browse:this.upload_button_click_handler,DragAndDrop:this.drag_and_drop_handler,PostInit:this.post_init_handler,FilesAdded:this.files_added_handler,Error:this.error_handler,UploadProgress:this.upload_progress_handler,FileUploaded:this.file_uploaded_handler}},this.uploader=new window.plupload.Uploader(t),this.uploader.init()},r.prototype._show_loading=function(e){return this.uploader.disableBrowse(!0),this.modal.setState({mode:i.UPLOADING,percent_uploaded:e})},r.prototype._show_error=function(e,t){var o,n;return this.uploader.disableBrowse(!1),this.modal.setState({mode:i.ERROR,error_message:e}),n={source:t},"function"==typeof(o=this.logger).on_error?o.on_error(n):void 0},r.prototype._show_photo_preview=function(e,t){var n,r,s;return this.uploader.disableBrowse(!0),s=this._update_photo_url(e),this.modal.setState({mode:i.CONFIRM,large_photo_url:s}),o(document).trigger("db:"+this.uploader_name+":photo_set",{saved_photo_url:s}),r={source:t},"function"==typeof(n=this.logger).on_photo_selected?n.on_photo_selected(r):void 0},r.prototype._update_photo_url=function(e){return e},r.prototype._disable_event_propagation_and_behavior=function(e){return e.stopPropagation(),e.preventDefault()},r.prototype._disable_drag_drop_beyond_dropzone=function(e){return o(document).on("dragenter dragover drop",this._disable_event_propagation_and_behavior)},r.prototype._enable_drag_drop_beyond_dropzone=function(e){return o(document).off("dragenter dragover drop",this._disable_event_propagation_and_behavior)},r.prototype._uploader_browse_button_disabled=function(){return o('.moxie-shim input[type="file"]').prop("disabled")},r})()})}.call(this),function(){define("modules/clean/photo_upload/mode_enum",[],function(){return{SELECT:"select",ERROR:"error",UPLOADING:"uploading",CONFIRM:"confirm"}})}.call(this),function(){define("modules/clean/photo_upload/ui",["jquery","external/react","modules/clean/account_photo_modal/mode_enum","modules/clean/react/image","modules/clean/react/button","modules/clean/static_urls","modules/core/i18n"],function(e,t,o,n,r,s,i){var a,l,u,c,d,_;return a=o.AccountPhotoModalMode,l=r.Button,_=s.static_url,u=i._,d=t.DOM,c=t.createElement,t.createClass({displayName:"PhotoUploadUI",propTypes:{on_mount:t.PropTypes.func,upload_button_id:t.PropTypes.string,upload_container_id:t.PropTypes.string,chooser_button_click_handler:t.PropTypes.func,start_over_button_click_handler:t.PropTypes.func,save_button_click_handler:t.PropTypes.func,done_button_click_handler:t.PropTypes.func,dismiss_handler:t.PropTypes.func,mode:t.PropTypes.string,reason_to_upload:t.PropTypes.oneOfType([t.PropTypes.string,t.PropTypes.object]),on_confirm_text:t.PropTypes.oneOfType([t.PropTypes.string,t.PropTypes.object]),on_finish:t.PropTypes.func,large_photo_url:t.PropTypes.string,dragover:t.PropTypes.bool,error_message:t.PropTypes.string,percent_uploaded:t.PropTypes.oneOfType([t.PropTypes.string,t.PropTypes.number]),can_choose_from_dropbox:t.PropTypes.bool,display_photo_on_select:t.PropTypes.bool,class_name:t.PropTypes.string,legal_note:t.PropTypes.string,drag_drop_message:t.PropTypes.string,error_message_title:t.PropTypes.string},getDefaultProps:function(){return{on_mount:function(){},upload_button_id:"",upload_container_id:"",chooser_button_click_handler:e.noop,start_over_button_click_handler:e.noop,save_button_click_handler:e.noop,done_button_click_handler:e.noop,dismiss_handler:e.noop,mode:a.SELECT,reason_to_upload:"",on_confirm_text:"",on_finish:e.noop,large_photo_url:"",dragover:!0,error_message:"",percent_uploaded:0,can_choose_from_dropbox:!1,display_photo_on_select:!1,class_name:"photo-upload",drag_drop_message:u("Drag and drop a photo"),error_message_title:u("Error")}},componentDidMount:function(){return this.props.on_mount()},render:function(){return d.div({id:this.props.upload_container_id,className:this.props.class_name},this.renderTopText(),this.renderCenterBox(),this.renderButtons())},renderTopText:function(){var e;return e=function(){switch(!1){case this.props.mode!==a.CONFIRM:return this.props.on_confirm_text;default:return this.props.reason_to_upload}}.call(this),d.div({className:"top-text"},e)},_renderCenterBoxDragOver:function(e,t){return e.push("green-box"),d.div({className:t},d.strong({},u("Drop file to upload")))},_renderCenterBoxSelect:function(e,t){var o;return e.push("gray-box"),e.push("clickable"),o=d.div({},d.strong({},this.props.drag_drop_message),d.br(),d.div({},u("or")),d.button({className:"button-tertiary"},u("Upload from computer"))),d.div({className:t},this.props.display_photo_on_select?(c(n,{src:_("/static/images/account_photo/landscape-vfl07nGZ_.png"),srcHiRes:_("/static/images/account_photo/landscape@2x-vflc9o2Xa.png"),className:"landscape"}),d.br()):void 0,o,d.div({className:"legal-note"},this.props.legal_note))},_renderCenterBoxError:function(e,t){return e.push("red-box"),e.push("clickable"),d.div({className:t},d.strong({},this.props.error_message_title),d.br(),this.props.error_message,d.br(),d.button({className:"button-tertiary"},u("Upload from computer")))},_renderCenterBoxUploading:function(e,t){var o;return e.push("gray-box"),o=this.props.percent_uploaded?u("%(percent_uploaded)s%(percent_symbol)s Uploading...",{comment:'"percent_symbol" will be substituted with an actual percent symbol'}).format({percent_symbol:"%",percent_uploaded:this.props.percent_uploaded}):u("Uploading..."),d.div({className:t},c(n,{src:_("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),srcHiRes:_("/static/images/icons/ajax-loading-small@2x-vflAxdZTP.gif"),className:"loading"}),d.br(),o)},_renderCenterBoxConfirm:function(e,t){return e.push("white-box"),d.div({className:t},d.div({className:"avatar-component photo circle c-avatar"},d.img({src:this.props.large_photo_url,className:"preview-photo"})))},renderCenterBox:function(){var e,t,o;switch(e=["center-box"],o="content",!1){case!this.props.dragover:t=this._renderCenterBoxDragOver(e,o);break;case this.props.mode!==a.SELECT:t=this._renderCenterBoxSelect(e,o);break;case this.props.mode!==a.ERROR:t=this._renderCenterBoxError(e,o);break;case this.props.mode!==a.UPLOADING:t=this._renderCenterBoxUploading(e,o);break;case this.props.mode!==a.CONFIRM:t=this._renderCenterBoxConfirm(e,o)}return d.div({id:this.props.upload_button_id,className:e.join(" ")},d.div({className:"inner-container"},t))},renderButtons:function(){return this.props.mode===a.CONFIRM?d.div({},c(l,{importance:"tertiary",id:this.props.upload_button_id,onClick:this.props.start_over_button_click_handler},u("Change photo")),c(l,{importance:"primary",className:"left-margin",onClick:this.saveButtonClickHandler},u("Done"))):this.props.can_choose_from_dropbox?d.div({},c(l,{importance:"tertiary",onClick:this.props.chooser_button_click_handler,disabled:this.props.mode===a.UPLOADING},u("Choose from Dropbox"))):void 0},saveButtonClickHandler:function(){return this.props.save_button_click_handler(),this.props.on_finish()}})})}.call(this),function(){var e=[].slice;define("modules/clean/photos/carousel_app/excluded_folders_modal",["external/react","modules/clean/ajax","modules/clean/browse_interface","modules/clean/css","modules/clean/react/button","modules/clean/react/modal","modules/clean/react/sprite","modules/clean/viewer","modules/core/i18n","modules/core/notify","jquery"],function(t,o,n,r,s,i,a,l,u,c,d){var _,p,h,f,m,y,g;return o.WebRequest,_=s.Button,p=i.Modal,m=t.DOM,f=t.createElement,h=u.i18n_default_project("photos")._,y=t.createClass({displayName:"excludedFoldersList",propTypes:{excludedPaths:t.PropTypes.array.isRequired,onUpdate:t.PropTypes.func.isRequired},getInitialState:function(){return{foldersToReinclude:{}}},stageForReinclusion:function(e,t){return t?this.state.foldersToReinclude[e]=!0:delete this.state.foldersToReinclude[e],this.setState(this.state.foldersToReinclude)},hasStagedChanges:function(){var e;for(e in this.state.foldersToReinclude)return!0;return!1},render:function(){var e,t,o;return e=this.props.excludedPaths.slice(),e.sort(function(e,t){return e.fq_path>t.fq_path}),m.div({},m.div({className:"excluded-folders-list"},function(){var n,r,s,i;for(i=[],n=0,r=e.length;n<r;n++)s=e[n],t=s.fq_path,o=s.in_shared_folder,i.push(f(g,{fqPath:t,key:t,isSharedFolder:o,stageForReinclusion:this.stageForReinclusion}));return i}.call(this)),m.div({className:"clearfix",style:{paddingBottom:5}},this.hasStagedChanges()?m.div({style:{float:"right"}},[f(_,{key:"update",style:{marginRight:5},onClick:(function(e){return function(){var t;return e.props.onUpdate(function(){var e;e=[];for(t in this.state.foldersToReinclude)e.push(t);return e}.call(e)),p.close()}})(this)},h("Update")),f(_,{key:"cancel",importance:"tertiary",onClick:(function(e){return function(){return c.error(h("No folders were added to your Timeline")),p.close()}})(this)},h("Cancel"))]):f(_,{style:{float:"right"},onClick:function(){return p.close()}},h("Close"))))}}),g=t.createClass({displayName:"folderRow",propTypes:{fqPath:t.PropTypes.string.isRequired,isSharedFolder:t.PropTypes.bool,stageForReinclusion:t.PropTypes.func.isRequired},getInitialState:function(){return{excluded:!0,hover:!1}},render:function(){var t,o,r,s,i,u;return t="Dropbox"+this.props.fqPath,s=t.split("/"),i=2<=s.length?e.call(s,0,r=s.length-1):(r=0,[]),o=s[r++],u=i.join("/")+"/",m.div({onMouseEnter:(function(e){return function(){return e.setState({hover:!0})}})(this),onMouseLeave:(function(e){return function(){return e.setState({hover:!1})}})(this),style:{clear:"both",backgroundColor:this.state.hover?"#deeefc":void 0,padding:"1px 5px",overflowY:"auto"}},f(a,{group:"web",name:this.props.isSharedFolder?"folder_user_32":"folder_32"}),m.div({style:{display:"inline-block",paddingLeft:"10px"}},m.span({style:{fontSize:"10pt"}},o),m.br({}),m.span({style:{fontSize:"10pt",color:"#999"}},u)),m.div({style:{float:"right"}},this.state.hover||!this.state.excluded?m.a({href:String(n.browse_uri_for_fq_path(l.get_viewer().photos_user,this.props.fqPath)),target:"_blank",style:{margin:"0 20px"}},h("Show in folder")):void 0,this.state.excluded?this.state.hover?f(_,{importance:"secondary",style:{marginTop:"5px"},onClick:(function(e){return function(){return e.setState({excluded:!1}),e.props.stageForReinclusion(e.props.fqPath,!0)}})(this)},h("Add to Timeline")):void 0:f(_,{style:{marginTop:"5px"},onClick:(function(e){return function(){return e.setState({excluded:!0}),e.props.stageForReinclusion(e.props.fqPath,!1)}})(this)},h("Added",{comment:"means the folder, which was previously removed from Carousel, has been added back to the user's Carousel"}))))}}),(function(){function e(){}return e.show=function(e,t){var o;return r.require_css("/static/css/carousel/app/excluded_folders_modal-vfl8sA_CD.css"),o={marginBottom:-25},p.showInstance(f(p,{title:h("Folders excluded from your Timeline"),width:Math.min(d(window).width()-400,900),onDismiss:function(e){return e.preventDefault()},acceptButtonText:null,showX:!1},m.div({style:o},m.p({},h("Photos and videos in these folders have been excluded from your Timeline")),f(y,{excludedPaths:e,onUpdate:t}))))},e})()})}.call(this),function(){define("modules/clean/photos/photos_tab_settings",["external/react","modules/clean/ajax","modules/clean/photos/carousel_app/excluded_folders_modal","modules/clean/static_urls","modules/clean/viewer","modules/core/i18n","modules/core/notify"],function(e,t,o,n,r,s,i){var a,l,u,c,d,_;return a=t.WebRequest,d=n.static_url,u=e.DOM,c=s.i18n_default_project("photos"),l=c._,_=c.ungettext,e.createClass({displayName:"ExcludedFoldersSettingsItem",getInitialState:function(){return{loading:!0,error:!1,excluded_paths:null}},componentDidMount:function(){return this.refreshExcludedPaths()},refreshExcludedPaths:function(){return a({url:"/app/ajax/get_excluded_folders",type:"GET",subject_user:r.get_viewer().photos_user,success:(function(e){return function(t){return t=JSON.parse(t),e.setState({loading:!1,excluded_paths:t.excluded_paths})}})(this),error:(function(e){return function(){return e.setState({loading:!1,error:!0})}})(this)})},reincludeCallback:function(e){return this.setState({loading:!0,error:!1}),a({url:"/app/ajax/reinclude_folders",subject_user:r.get_viewer().photos_user,data:{fq_paths:JSON.stringify(e)},success:function(){return i.success(l("These folders will be added to your Photos tab momentarily"))},error:function(){return i.error(l("Something went wrong - your changes weren’t successfully saved"))},complete:(function(e){return function(){return e.refreshExcludedPaths()}})(this)})},render:function(){var e;return this.state.loading?u.div({},u.img({src:d("/static/images/loading-big-vfl-qdOjG.gif"),alt:l("Loading...")})):this.state.error?u.div({},l("Failed to load excluded folders list")):(null!=(e=this.state.excluded_paths)?e.length:void 0)>0?u.p({},[u.span({key:"num_excluded_folders"},_("%(num)d excluded folder","%(num)d excluded folders",this.state.excluded_paths.length).format({num:this.state.excluded_paths.length})),u.span({key:"nbsp"}," "),u.a({key:"change_link",onClick:(function(e){return function(){return o.show(e.state.excluded_paths,e.reincludeCallback,!0)}})(this)},l("Change"))]):u.p({},l("No folders excluded"))}})})}.call(this),function(){define("modules/clean/profile",["jquery","modules/core/i18n","modules/core/notify","modules/clean/form"],function(e,t,o,n){var r,s;return s=t._,r={init:function(){return e(".account-inputs input").on("click",r.show_pref_submit),e(".account-inputs select").on("change",r.show_pref_submit),e("#prefs-cancel").on("click",r.reset_prefs),e("#prefs-submit").on("click",r.hide_pref_submit)},listen_prefs_submit:function(){return e("#profile-prefs").submit(function(t){return t.preventDefault(),n.submit(e(this),function(){return o.success(s("Update successful"))},function(e){return o.error(e)})})},show_pref_submit:function(t){return e("#prefs-submit").removeClass("hidden"),e("#prefs-cancel").removeClass("hidden")},hide_pref_submit:function(t){return e("#prefs-submit").addClass("hidden"),e("#prefs-cancel").addClass("hidden")},reset_prefs:function(t){return t.preventDefault(),e("#profile-prefs")[0].reset(),r.hide_pref_submit(t)}},{Profile:r}})}.call(this),function(){define("modules/dirty/account",["jquery","modules/core/exception","modules/core/i18n","modules/core/notify","modules/clean/ajax","modules/clean/profile_services/profile_services_constants","modules/clean/profile_services/profile_services_link","modules/clean/multiaccount_login","modules/clean/react/modal","modules/clean/viewer"],function(e,t,o,n,r,s,i,a,l,u){var c,d,_,p;return t.assert,p=o._,i.LinkedProfileServices,d=i.ProfileServicesLinkingHandler,_=l.SimpleModal,c={link_handler:function(){return new d},get_content_tab_selector:function(e){return u.get_viewer().is_paired&&e&&!location.href.endsWith("settings")?"#"+e+"-content":""},self_unban:function(){return e("#self-unban-form").submit()},show_account_login_modal:function(){return a.show_page_login_modal(window.location.href)},purge_contacts:function(t){return new Ajax.DBRequest("/account/purge_contacts",{subject_user:t,onSuccess:function(){var o;return o=c.get_content_tab_selector(u.get_viewer().get_user_by_id(t).role),e(o+" .deauth-facebook").hide(),e(o+" .auth-facebook").show(),e(o+" .auth-gmail").show(),e(o+" .deauth-gmail").hide(),e(o+" .auth-yahoo-mail").show(),e(o+" .deauth-yahoo-mail").hide(),e(o+" .auth-outlook").show(),e(o+" .deauth-outlook").hide(),e(o+" .remove-contact-sources").hide(),n.success(p("All contacts removed from Dropbox"))},onFailure:function(){return n.error(p("There was a problem removing your contacts"))}})},init:function(){return this.init=function(){},e(".auth-gmail-link").on("click",function(t){var o,r;return t.preventDefault(),r=e(this).attr("data-user-id"),o=function(t){var o;return t.success?(o=c.get_content_tab_selector(u.get_viewer().get_user_by_id(r).role),null!=t.profile?e(o+" .gmail-address").text(t.profile.email):e(o+" .gmail-address").text(p("Connected")),e(o+" .auth-gmail").hide(),e(o+" .deauth-gmail").show(),n.success(p("Imported Gmail Contacts."))):n.error(t.err_msg||p("We need your permission to import your Gmail contacts."))},c.link_handler().auth_service_with_user(s.GOOGLE,r,o)}),e(".auth-yahoo-link").on("click",function(t){var o,r;return t.preventDefault(),r=e(this).attr("data-user-id"),o=function(t){var o;return t.success?(o=c.get_content_tab_selector(u.get_viewer().get_user_by_id(r).role),e(o+" .auth-yahoo-mail").hide(),e(o+" .deauth-yahoo-mail").show(),n.success(p("Imported Yahoo! Mail contacts."))):n.error(t.err_msg||p("We need your permission to import your Yahoo! Mail contacts."))},c.link_handler().auth_service_with_user(s.YAHOO,r,o)}),e(".auth-outlook-link").on("click",function(t){var o,r;return t.preventDefault(),r=e(this).attr("data-user-id"),o=function(t){var o,s,i;return t.success?(i=c.get_content_tab_selector(u.get_viewer().get_user_by_id(r).role),o=t.success&&null!=(null!=(s=t.profile)?s.email:void 0)?t.profile.email:p("Connected"),e(i+" .outlook-address").text(o),e(i+" .auth-outlook").hide(),e(i+" .deauth-outlook").show(),n.success(p("Imported Outlook contacts."))):n.error(t.err_msg||p("We need your permission to import your Outlook contacts."))},c.link_handler().auth_service_with_user(s.OUTLOOK,r,o)}),e(".deauth-gmail-link").on("click",function(t){var o,r;return t.preventDefault(),r=e(this).attr("data-user-id"),o=function(t){var o;return t?(o=c.get_content_tab_selector(u.get_viewer().get_user_by_id(r).role),e(o+" .auth-gmail").show(),e(o+" .deauth-gmail").hide(),e(o+" .auth-gmail-login").show(),e(o+" .deauth-gmail-login").hide(),n.success(p("Successfully removed Google contacts."))):n.error(p("We were unable to remove your Gmail contacts"))},c.link_handler().deauth_service(s.GOOGLE,r,null,o)}),e(".deauth-yahoo-link").on("click",function(t){var o,r;return t.preventDefault(),r=e(this).attr("data-user-id"),o=function(t){var o;return t?(o=c.get_content_tab_selector(u.get_viewer().get_user_by_id(r).role),e(o+" .auth-yahoo-mail").show(),e(o+" .deauth-yahoo-mail").hide(),n.success(p("Successfully removed Yahoo! Mail contacts."))):n.error(p("We were unable to remove your Yahoo! Mail contacts."))},c.link_handler().deauth_service(s.YAHOO,r,null,o)}),e(".deauth-facebook-link").on("click",function(t){var o,r;return t.preventDefault(),r=e(this).attr("data-user-id"),o=function(t){var o;return t?(o=c.get_content_tab_selector(u.get_viewer().get_user_by_id(r).role),e(o+" .facebook-username").text(""),e(o+" .facebook-linking").hide(),n.success(p("Disconnecting your account from Facebook..."))):n.error(p("We were unable to disconnect from Facebook."))},c.link_handler().deauth_service(s.FACEBOOK,r,null,o)}),e(".deauth-outlook-link").on("click",function(t){var o,r;return t.preventDefault(),r=e(this).attr("data-user-id"),o=function(t){var o;return t?(o=c.get_content_tab_selector(u.get_viewer().get_user_by_id(r).role),e(o+" .outlook-address").text(""),e(o+" .auth-outlook").show(),e(o+" .deauth-outlook").hide(),n.success(p("Disconnecting your account from Outlook.com..."))):n.error(p("We were unable to disconnect from Outlook.com."))},c.link_handler().deauth_service(s.OUTLOOK,r,null,o)}),e(".show-mobile-detail-link").on("click",function(t){var o,n;return t.preventDefault(),n=e(this).attr("data-user-id"),o=c.get_content_tab_selector(u.get_viewer().get_user_by_id(n).role),e(o+" .mobile-contacts-detail").slideDown(150),e(o+" .hide-mobile-detail-link").show(),e(o+" .show-mobile-detail-link").hide()}),e(".hide-mobile-detail-link").on("click",function(t){var o,n;return t.preventDefault(),n=e(this).attr("data-user-id"),o=c.get_content_tab_selector(u.get_viewer().get_user_by_id(n).role),e(o+" .mobile-contacts-detail").slideUp(150),e(o+" .hide-mobile-detail-link").hide(),e(o+" .show-mobile-detail-link").show()}),e(".purge-all-contacts-link").on("click",function(t){var o;return t.preventDefault(),o=e(this).attr("data-user-id"),_.show({title_text:p("Remove all services and imported contacts?"),body_html:"<p> <t> This will remove all of your imported contacts from Dropbox, disconnect any connected social and email services and sign you out of Dropbox mobile apps. If you sign into those apps later, your contacts may be imported to Dropbox again. </t> </p>",cancel_text:p("Cancel"),confirm_text:p("Remove all"),confirm_callback:(function(e){return function(){return c.purge_contacts(o)}})(this)})})}},INLINE_JS.AccountPage=c})}.call(this);
//# sourceMappingURL=pkg-legacy-ai.min.js-vfltBzYCt.map