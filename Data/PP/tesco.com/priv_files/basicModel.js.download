define(["modernizr","easing","appear","gifplayer"],function(){function n(){var n;window.XMLHttpRequest?(n=new XMLHttpRequest,n.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var t;if(null!=n.responseText)try{t=JSON.parse(n.responseText),t.signedIn&&(document.getElementById("link_sign_in").innerHTML="Sign out",document.getElementById("link_sign_in_mob").innerHTML="Sign out",document.getElementById("link_sign_in").href="https://secure.tesco.com/account/en-GB/logout?from=https%3A%2F%2Fwww.tesco.com%2Fhelp%2Fprivacy-and-cookies%2Fprivacy-centre%2F",document.getElementById("link_sign_in_mob").href="https://secure.tesco.com/account/en-GB/logout?from=https%3A%2F%2Fwww.tesco.com%2Fhelp%2Fprivacy-and-cookies%2Fprivacy-centre%2F")}catch(n){window.console&&console.log("Error: invalid auth response format.")}}},n.open("GET","/ce-assets/checkAuth",!0),n.send()):n=new ActiveXObject("Microsoft.XMLHTTP")}function t(){var n=$("body"),t=$("#header"),o=t.find(".btn-mobile"),e=t.find(".close-menu");o.on("click",function(o){o.preventDefault(),n.addClass("mobile-menu-open"),t.addClass("mobile-menu-open animating"),$(".burger-menu-wrapper").one("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",function(){t.removeClass("animating").addClass("animated")})}),e.on("click",function(o){o.preventDefault(),n.removeClass("mobile-menu-open"),t.removeClass("mobile-menu-open animating"),$(".burger-menu-wrapper").one("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",function(){t.removeClass("animated")})})}function o(){var n=$("#sidebar");$(window).width()<992?(n.find(".sidebar-menu").removeClass("in").height(0),n.find(".btn-toggle").addClass("collapsed")):$(window).width()>=992&&(n.find(".sidebar-menu").addClass("in").height("auto"),n.find(".btn-toggle").removeClass("collapsed"));var t,o=$(".slide-parent").parent(),e=$(".slide-parent").parent().height();$(".slide-parent").each(function(n){t=$(this);var e=t.find(".slide-children"),i=e.height();$(this).find(".sub-menu-link").on("click",function(n){n.preventDefault(),t=$(this).closest("ul"),t.add(".menu-slide").addClass("sub-menu-open"),o.find("ul.slide-section").not(".sub-menu-open, .sub-section").hide(),o.height(i)})}),$("#menu-button").on("click",function(n){if($(this).parent().hasClass("sub-menu-open")){n.preventDefault(),n.stopPropagation();$(this).parent().removeClass("sub-menu-open"),o.find("ul.slide-section").not(".sub-menu-open").show(),o.find("*").each(function(){$(this).removeClass("sub-menu-open")}),o.height(e)}})}function e(){var n=$(document).width(),t=$("#footer"),o=t.find(".group-title");n<768?($.each(o,function(){$(this).hasClass("link-item")||$(this).replaceWith($('<button class="group-title">'+this.innerHTML+"</button>"))}),$("button.group-title").on("click",function(n){n.preventDefault();var t=$(this).next(".links-ul");$(this).parent().toggleClass("expanded"),t.slideToggle()})):$.each(o,function(){$(this).hasClass("link-item")||$(this).replaceWith($('<p class="group-title">'+this.innerHTML+"</p>"))})}function i(){var n=$(".block-left"),t=$(".block-right"),o=$(".tall-block"),e=$(".short-block"),i=$(".flat-block");if(o.length||i.length){var a=".featured-wrapper",s=-1,l=-1;o.each(function(){s=s>$(this).innerHeight()?s:$(this).innerHeight()}),e.each(function(){l=l>$(this).innerHeight()?l:$(this).innerHeight()}),o.each(function(){$(this).parents(a).height(s),(n.length||t.length)&&(n.find(a).css("padding-bottom","10px"),$(".cover-lg").height(s-4))}),e.each(function(){$(this).parents(a).height(l)}),i.each(function(){(n.length||t.length)&&$(this).parents(a).height(n.height()-s-12)})}}function a(){var n=$(".scroll-panel"),t=!1;if(n.length){var o=n.first(),e=0;$(".page-your-data-and-tesco").length&&(e=50),$(".scroll-first").on("click",function(n){$("html, body").stop().animate({scrollTop:o.offset().top-e},1200),n.preventDefault()}),n.appear().on("appear",function(){if($(this).addClass("opaque"),"section5"==$(this).attr("ID")&&!t){var n=$("#section5top").attr("src");$("#section5top").attr("src",n);var n=$("#section5bottom").attr("src");$("#section5bottom").attr("src",n),t=!0}}),n.appear().on("disappear",function(){$(this).removeClass("opaque")}),$.force_appear(n),$(window).bind("mousewheel",function(){$("html, body").stop()})}}function s(){var n=$(window).height(),t=$(".back-to-top.anchored");$(window).on("scroll",function(){$(window).scrollTop()>=n?t.addClass("anchor-visible"):t.removeClass("anchor-visible")}),$(".back-to-top.anchored a").on("click",function(n){return n.preventDefault(),$("html, body").animate({scrollTop:0},500),!1})}function l(){var n=$("#modal"),t=$(".close-modal");n.on("shown.bs.modal",function(){document.activeElement.blur(),t.focus()})}!function(){$("#utility-bar").length>0&&($("body").hasClass("home")?$("#utility-bar").load("common/utility-bar.html",function(){}):$("body").hasClass("sso")||$("body").hasClass("tayd")||$("body").hasClass("pp")?$("#utility-bar").load("../../common/utility-bar.html",function(){}):$("#utility-bar").load("../common/utility-bar.html",function(){})),n()}(),function(){$("#pc-header").length>0&&($("body").hasClass("home")?$("#pc-header").load("common/header.html",function(){}):$("body").hasClass("sso")||$("body").hasClass("tayd")||$("body").hasClass("pp")?$("#pc-header").load("../../common/header.html",function(){}):$("#pc-header").load("../common/header.html",function(){}))}(),function(){$("#footer").length>0&&($("body").hasClass("home")?$("#footer").load("common/footer.html",function(){}):$("body").hasClass("sso")||$("body").hasClass("tayd")||$("body").hasClass("pp")?$("#footer").load("../../common/footer.html",function(){}):$("#footer").load("../common/footer.html",function(){}))}(),function(){$("#backToTop").length>0&&($("body").hasClass("page-your-rights")?$("#backToTop").load("../common/back-to-top.html",function(){}):$("#backToTop").load("../../common/back-to-top.html",function(){}))}(),function(){var n=$(".gif");n.gifplayer({label:'<svg class="icon_play" viewBox="0 0 22 20"><polygon class="a" points="5.5 3 18 10 5.5 17 5.5 3"/></svg>',wait:!0,onPlay:function(){$(".play-gif").attr("tabindex","-1")}}),$(".gp-gif-element").on("click",function(){n.gifplayer("stop")})}(),function(){$("#main").length>0&&($("body").hasClass("home")&&$.get("common/ajax.txt",function(n,t){}),$("body").hasClass("pp")&&$.get("../../common/ajax.txt",function(n,t){}))}(),$(document).ajaxComplete(function(){t(),o(),e(),i(),a(),s(),l(),$(window).resize(function(){o(),e(),i()})})});