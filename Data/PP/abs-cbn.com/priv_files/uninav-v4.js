var store={baseUrl:window.location.protocol+"//"+window.location.host,kapamilyaUrl:"https://kapamilyaaccounts.abs-cbn.com/",domainKeys:"https://assets.abs-cbn.com/universalnav/live/sso-domain.json"};
!function(a){"use strict";a.ajaxPrefilter(function(a,e,n){"script"!==a.dataType&&"script"!==e.dataType||(a.cache=!0)}),a.fn.uninav=function(e){function n(){t.sso&&o.connection(),l.headerMarkup(),l.createSplash()}var i={domain:document.domain,type:"",uninav:!1,uninavAnimation:!0,uninavAnimationSpeed:"fast",mobileNav:!0,dataDomain:"",oldsearch:!0,headerSticky:!1,sso:!0,ssoApikey:"",customDashBoard:[],domainKey:"",referrer:"",ssoPageURL:store.kapamilyaUrl},t=this.config=a.extend(i,e),o={location:function(a){if(/MSIE (\d+\.\d+);/.test(navigator.userAgent)){var e=document.createElement("a");e.href=a,document.body.appendChild(e),e.click()}else location.href=a},connection:function(){a.getJSON(store.domainKeys,function(e){t.ssoApikey=o.setApikeKey(e),a("head").prepend(o.loadScript(t.ssoApikey)),o.loadGigyaScript(t.ssoApikey)})},setApikeKey:function(a){return""!==t.domainKey?a[t.domainKey]:a[t.dataDomain]},loadScript:function(a){var e="",n=(new Date).getTime();return void 0===window.__gigyaConf&&(e='<script type="text/javascript">window.__gigyaConf = {"enableSSOToken": true}</script>'),e+='<script type="text/javascript" src="'+o.setScriptSource()+"?apikey="+a+"&timestamp="+n+'"></script>',e+='<script type="text/javascript" src="//assets.abs-cbn.com/sso/sso-behavior.js"></script>'},setScriptSource:function(){return"https:"===window.location.protocol?"https://cdns.gigya.com/JS/gigya.js":"http://cdn.gigya.com/JS/gigya.js"},loadGigyaScript:function(e){a("script[src*='gigya.com/JS/gigya.js?apikey="+e+"']").load(function(){o.gigyaApi()})},gigyaApi:function(){void 0===typeof gigya?(console.log("please wait giya function is still loading.."),o.gigyaApi()):o.getAccountInformation()},getAccountInformation:function(){gigya.accounts.getAccountInfo({include:"loginIDs,profile,data",callback:function(e){"FAIL"===e.status?(s.activate([],!0),a(".login-icon-uninav").html(l.notLogin()),a("body").attr("data-login","false")):(r.list(e.data),a(".login-icon-uninav").html(l.alreadyLogin(e)),l.createSSOsubNavMarkup(e),o.commentingLogout(),a("body").attr("data-login","true"))}})},commentingLogout:function(){gigya.accounts.addEventHandlers({onLogout:function(){o.location(t.ssoPageURL+"/logout")}})}},s={activate:function(e,n){a(".bookmarked").removeAttr("disabled"),a(document).on("click",".bookmarked",function(i){if(i.preventDefault(),n){var o='<a href="'+t.ssoPageURL+'"><strong>Login</strong> to your Kapamilya Account to save this article and read it later.</a>';return void r.bubblePopup(o,a(this).parent(),6e3)}var l=a(this);if(!l.hasClass("article-saved")){var c='<div class="my-blocker"></div><div class="loader-icon"></div>';l.parent().append(c);var d=l.parents("article");e.push(s.generateArticle(d)),r.article(e,l)}})},generateArticle:function(e){var n={articleId:(new Date).getTime().toString(),saveDate:s.getDateNow(),readed:!1,title:e.find('meta[itemprop="headline"]').attr("content"),shortDesc:e.find('meta[itemprop="description"]').attr("content"),thumbnail:e.find('meta[itemprop="thumbnailUrl"]').attr("content"),urlLink:e.find('meta[itemprop="url"]').attr("content"),siteSrc:a('meta[property="og:site_name"]').attr("content")};return n},getDateNow:function(){var a=new Date,e=a.getFullYear(),n=a.getDate(),i=a.getMonth();switch(i){case 0:i="January";break;case 1:i="Febuary";break;case 2:i="March";break;case 3:i="April";break;case 4:i="May";break;case 5:i="June";break;case 6:i="July";break;case 7:i="August";break;case 8:i="September";break;case 9:i="October";break;case 10:i="November";break;case 11:i="December"}return i+" "+n+", "+e},scrollActivate:function(e){r.artLen=a(".bookmarked").parents("article").length,a(window).scroll(function(){var e=a(".bookmarked").parents("article").length;r.artLen<e&&(r.artLen=e,r.setSavedArticle())})}},r={data:[],title:[],artLen:0,list:function(a){a.readList?(r.data=a.readList,r.setTitleHolder(a.readList),s.activate(r.data,!1)):s.activate([],!1)},setTitleHolder:function(e){a.each(e,function(a,e){r.title.push(e.title)}),r.setSavedArticle(r.title)},setSavedArticle:function(){var e=a(".bookmarked").parents("article");a.each(e,function(e,n){var i=a(n),t=i.find('meta[itemprop="headline"]').attr("content"),o=i.find(".bookmarked-saved-container");r.isSaved(r.title,t)?o.html('<button class="bookmarked article-saved"><span>Saved</span></button>'):o.html('<button class="bookmarked"><span>Save</span></button>')}),s.scrollActivate()},isSaved:function(a,e){return a.indexOf(e)>-1},article:function(a,e){var n={data:{readList:a},callback:function(a){0===a.errorCode?(e.parent().find(".my-blocker").remove(),e.parent().find(".loader-icon").remove(),r.setTitleHolder(r.data),e.addClass("article-saved"),e.find("span").html("Saved")):readingList.createTempBubblePopup("An error has occurred!<br>Error details: "+a.errorMessage+"<br>Error code: "+a.errorCode+"<br>In method: "+a.operation,5e3)}};gigya.accounts.setAccountInfo(n)},bubblePopup:function(e,n,i){a(".bookmark-saved").remove();var t=a('<div class="bookmark-saved">'+e+"</div>").fadeIn("fast").appendTo(n);i=i?3e3:i;var o=setInterval(function(){t.fadeOut("slow"),t.remove(),clearInterval(o)},i)}};a(document).on("click","body",function(){a(".uninav-main, .triangle-top, .triangle-bottom").hide(),a(".gigya-expanded-profile").css("cssText","display: none;"),l.isTemp=0}),a(document).on("click",".uninav-main, .gigya-expanded-profile",function(a){a.stopPropagation()}),a(document).on("click",".network-uninav",function(e){e.stopPropagation(),a(".gigya-expanded-profile, .triangle-top, .triangle-bottom").hide(),a(".uninav-main").slideToggle("fast"),l.isTemp=0}),a(document).on("click",".login-icon-uninav",function(e){if(e.stopPropagation(),"LOADING.."!==a(this).text())if(a(this).hasClass("active")||a(this).hasClass("without-photo")){a(".uninav-main").hide();var n=a(this).offset().left+15;a(".triangle-top, .triangle-bottom").css({left:n+"px"}),a(".triangle-top, .triangle-bottom").toggle(),0===l.isTemp?(a(".gigya-expanded-profile").css("cssText","display: block; left: initial !important; top:40px !important"),l.isTemp=1):(a(".gigya-expanded-profile").css("cssText","display: none;"),l.isTemp=0)}else{var i=l.returnSiteName().toLowerCase();l.loginClick(i)}}),a(document).on("click","header .header-bar button.header-nav-toggle",function(e){e.stopPropagation(),a(this).toggleClass("collapsed"),a("#header-collapse").toggleClass("in"),a(this).hasClass("collapsed")?(a(this).attr("aria-expanded","false"),a("#header-collapse").attr("aria-expanded","false")):(a(this).attr("aria-expanded","true"),a("#header-collapse").attr("aria-expanded","true"))}),t.oldsearch===!1?(a(document).on("click",".uninav-icon-search",function(e){e.preventDefault();var n=a(this).parent();n.toggleClass("active"),n.is(".active")?(a("header").append(l.createSearchPopup()),a("#mobile-search").fadeIn("fast"),a("body, html").css({overflow:"hidden"})):(a("#mobile-search").fadeOut().remove(),a("body, html").css({overflow:""}))}),a(document).on("focus",'input[mobile-input="search"]',function(){a(this).siblings("span").stop().addClass("active")}),a(document).on("focusout",'input[mobile-input="search"]',function(){""===a('input[mobile-input="search"]').val()?a(this).siblings("span").stop().removeClass("active"):(a(this).siblings("span").stop().addClass("active"),a('input[mobile-input="search"]').val())}),a(document).on("click",".search-form span",function(){a('input[mobile-input="search"]').focus()}),a(document).on("touchstart click",".uninav-close",function(e){e.preventDefault(),a("#mobile-search").remove(),a(".uninav-icon-search-new").removeClass("active"),a("body, html").css({overflow:""}),a(".uninav-icon-search").parent().removeClass("active")})):t.oldsearch===!0&&(a(".search-container-lg .search-container").show(),a(".uninav-icon-new.uninav-icon-search").parents("li").hide()),a(document).on("touchstart click",".uninav-close",function(e){e.preventDefault(),a("#mobile-search").remove(),a(".uninav-icon-search-new").removeClass("active"),a("body, html").css({overflow:""}),a(".uninav-icon-search").parent().removeClass("active")}),a(document).on("click",".dashboard-logout",function(){gigya.accounts.logout({callback:function(){o.location(t.ssoPageURL+"/logout")}})}),a(document).on("click",".btn-cancel",function(){a(".lightbox").hide()}),a(document).on("click",".has-child-drop",function(){a(this).parents(".header-subnav-showpage").length>0?a(this).parents(".header-subnav-showpage").find("ul").slideToggle("fast"):a(this).parents("li").find("ul").slideToggle("fast")}),a(document).on("click",".btn-proceed",function(){l.goToKapamilyaLogin()});var l={isTemp:0,isActive:!0,headerMarkup:function(){a("#uninav-toggle").remove();var e="";e+='<div class="main-uninav-header">',e+='<div class="right-container login-icon-uninav">',e+='<span class="login-loading">LOADING..</span>',e+="</div>",e+='<div class="left-container network-uninav">',e+="NETWORK",e+="</div>",e+="</div>",a("header.uninav-header").append(e),a("header.uninav-header .header-fixed").css("top","30px"),l.uninavMarkup(),t.oldsearch===!1&&a(".header-bar-inner h1.logo").append(l.createSearchIcon())},createSearchIcon:function(){var a="";return a+='<a href="javascript:void(0);" style="position: absolute; top: 0; right: 0; width: 50px;">',a+='<i class="uninav-icon-new uninav-icon-search">',a+='<span class="sr-only">search</span>',a+="</i>",a+="</a>"},notLogin:function(){return a(".login-icon-uninav").addClass("inactive"),"LOGIN"},alreadyLogin:function(e){var n="";return void 0===e.profile.photoURL?a(".login-icon-uninav").addClass("without-photo"):(a(".login-icon-uninav").addClass("active"),n+='<i style="'+l.userLoginStyles(e.profile.photoURL)+'"></i>'),n+=l.setUserName(e.loginIDs.username)},userLoginStyles:function(a){var e="";return e+="background-image:url("+a+");",e+="width: 20px;",e+="height: 20px;",e+="display: inline-block;",e+="border-radius: 50%;",e+="background-size: 100% 100%;",e+="position: relative;",e+="margin: 0px 5px 0px 15px;",e+="top: 5px;"},setUserName:function(a){return a.length>10?a.substr(0,10)+"..":a},markActive:function(){switch(t.domain){case"oneforpacman.abs-cbn.com":t.domain="sports.abs-cbn.com";break;case"entertainment.abs-cbn.com":case"entertainment2.abs-cbn.com":t.domain="//entertainment.abs-cbn.com/";break;case"news.abs-cbn.com":"/patrolph"===window.location.pathname?t.domain="//news.abs-cbn.com/patrolph":t.domain="//news.abs-cbn.com/";break;case"corporate.abs-cbn.com":"investorrelations"===window.location.pathname?e.activeDomain="//corporate.abs-cbn.com/investorrelations":"stellar"===window.location.pathname?e.activeDomain="//corporate.abs-cbn.com/stellar":e.activeDomain="//corporate.abs-cbn.com/investorrelations";break;case"ktx.abs-cbn.com":t.domain="//ktx.abs-cbn.com/?utm_source=uni-nav&utm_medium=link&utm_content=ktx";break;default:t.domain="//"+t.domain+"/"}a('.uninav-main .uninav-container a[href="'+t.domain+'"]').removeAttr("href").addClass("active")},uninavMarkup:function(){var e='<div class="uninav-main" style="top:30px;"><div class="uninav-container"><h2 class="uninav-main-heading">Welcome to your one-stop hub for everything Kapamilya!<br>Where would you like to go next?</h2></div><div class="uninav-main-divider"></div><div class="uninav-container"><div class="uninav-main-links clearfix"><div class="uninav-main-links-bp-left"><ul class="uninav-main-links-group"><li><a target="_blank" href="//entertainment.abs-cbn.com/">ABS-CBN Entertainment</a></li><li><a target="_blank" href="//news.abs-cbn.com/">ABS-CBN News</a></li><li><a target="_blank" href="//sports.abs-cbn.com/">ABS-CBN Sports</a></li><li><a target="_blank" href="//lifestyle.abs-cbn.com/">ABS-CBN Lifestyle</a></li><li><a target="_blank" href="//store.abs-cbn.com/">ABS-CBN Store</a></li><li><a target="_blank" href="//bmpm.abs-cbnnews.com/">BMPM</a></li><li><a target="_blank" href="//cablechannels.abs-cbn.com/">Cable Channels</a></li><li><a target="_blank" href="//www.choosephilippines.com/">Choose Philippines</a></li><li><a target="_blank" href="//dzmm.abs-cbnnews.com/">DZMM</a></li></ul><ul class="uninav-main-links-group"><li><a target="_blank" href="//thankyou.abs-cbn.com/">KAPAMILYA Thank You</a></li><li><a target="_blank" href="//ktx.abs-cbn.com/?utm_source=uni-nav&utm_medium=link&utm_content=ktx">KTX</a></li><li><a target="_blank" href="//www.mor1019.com/">MOR 101.9</a></li><li><a target="_blank" href="//myxph.com/">MYX PH</a></li><li><a target="_blank" href="//www.onemusic.ph/">One Music</a></li><li><a target="_blank" href="//news.abs-cbn.com/patrolph">Patrol.ph</a></li><li><a target="_blank" href="//push.abs-cbn.com/">Push</a></li><li><a target="_blank" href="//starcinema.abs-cbn.com/">Star Cinema</a></li><li><a target="_blank" href="//starcreatives.abs-cbn.com/">Star Creatives</a></li><li><a target="_blank" href="//starmusic.abs-cbn.com/">Star Music</a></li></ul></div><div class="uninav-main-links-bp-right"><ul class="uninav-main-links-group"><li><ul><li><a target="_blank" href="//tfcmyremit.com/">TFC MyRemit</a></li><li><a target="_blank" href="//www.tfc.tv/">TFC.TV</a></li></ul></li><li><ul><li><a target="_blank" href="//abscbnmobile.com/">ABS-CBNmobile</a></li><li><a target="_blank" href="//www.iwantv.com.ph/">iWant TV</a></li><li><a target="_blank" href="//tvplus.abs-cbn.com/">ABS-CBN TVplus</a></li></ul></li><li><ul><li><a target="_blank" href="//www.mysky.com.ph/">SKY</a></li><li><a target="_blank" href="//www.mysky.com.ph/skyondemand">SKY On-Demand</a></li></ul></li></ul><ul class="uninav-main-links-group"><li><a target="_blank" href="//corporate.abs-cbn.com/">ABS-CBN Corporate</a></li><li><a target="_blank" href="//chickenporkadobo.abs-cbn.com/">Adober Studios</a></li><li><a target="_blank" href="//careers.abs-cbn.com/">Careers</a></li><li><a target="_blank" href="//www.abs-cbnfoundation.com/">Foundation</a></li><li><a target="_blank" href="//internationalsales.abs-cbn.com/">International Sales</a></li><li><a target="_blank" href="//corporate.abs-cbn.com/investorrelations/">Investor Relations</a></li><li><a target="_blank" href="//marketportal.abs-cbn.com/">Market Portal</a></li><li><a target="_blank" href="//starmagicphils.abs-cbn.com/">Star Magic</a></li><li><a target="_blank" href="//corporate.abs-cbn.com/stellar/">Stellar</a></li></ul></div></div></div></div>';a("header").append(e),l.markActive()},createSSOsubNavMarkup:function(e){var n=e.profile.photoURL?e.profile.photoURL:"//assets.abs-cbn.com/universalnav/img/no-image-logo.png",i=e.profile.firstName?e.profile.firstName:"",o=e.profile.lastName?e.profile.lastName:"",s="";s+='<div class="triangle-top"></div><div class="triangle-bottom"></div>',s+='<div class="gigya-expanded-profile">',s+='<div class="gigya-expanded-profile-account">',s+='<img class="gigya-expanded-photo" src="'+n+'"/ >',s+='<div class="kapamilya-info">',s+='<p class="kapamilya-name" title="'+e.loginIDs.username+'" >',s+=e.loginIDs.username,s+="</p>",s+='<p class="full-name">',s+=i+" "+o,s+="</p>",s+="</div>",s+="<div>",s+="<ul>",s+="<li>",s+='<a href="'+t.ssoPageURL+'profile">My Kapamilya Account</a>',s+="</li>",a.each(t.customDashBoard,function(a,e){s+="<li>",s+='<a href="'+e.url+'">'+e.title+"</a>",s+="</li>"}),s+="<li>",s+='<a href="javascript:void(0);" class="dashboard-logout">Log out</a>',s+="</li>",s+="</ul>",s+="</div>",s+="<div>",s+="</div>",a("header.uninav-header").append(s)},lastScroll:0,scrollAnimationHeader:function(e){if(t.headerSticky===!1){if(l.lastScroll>=e.scrollTop()){if(a("head-bar button").hasClass("collapsed"))a("header").removeClass("header-sticky");else if(e.scrollTop()<=0)return a("header").removeClass("header-sticky"),!1;e.width()<=768&&a("header .header-fixed").removeClass("header-fixed-unpinned")}else a("header").addClass("header-sticky"),parseInt(e.width())<=768&&a("header .header-fixed").addClass("header-fixed-unpinned");l.lastScroll=e.scrollTop()}},addButtonCollasible:function(){var a="";return a+='<button type="button" class="navbar-toggle collapsed header-nav-toggle" data-toggle="collapse" data-target="#header-collapse" aria-expanded="false">',a+='<span class="sr-only">Toggle navigation</span>',a+='<span class="icon-bar"></span>',a+='<span class="icon-bar"></span>',a+='<span class="icon-bar"></span>',a+="</button>"},createSearchPopup:function(){var a="";return a+='<div id="mobile-search">',a+='<div class="uninav-search">',a+='<form class="search-form" autocomplete="off">',a+='<input class="search-field" type="search" name="search" placeholder="" mobile-input="search"/>',a+="<span>Search</span>",a+='<div class="uninav-close" data-icon="M"></div>',a+='<input type="submit" value="" class="uninav-icon-new uninav-icon-search search-button" />',a+="</form>",a+="</div>",a+="</div>"},createSplash:function(){var e="";e+='<section class="lightbox">',e+='<div class="content">',e+='<div class="header">',e+="<p>",e+='<a href="#">',e+='<span><img src="//assets.abs-cbn.com/universalnav/img/logo-abs-cbn.png" alt="ABS-CBN Corporation" class="kapamilya-accounts-bar"></span>',e+='<span class="'+l.returnSiteName().toLowerCase()+'">'+l.returnSiteName()+"</span>",e+="</a>",e+="</p>",e+="</div>",e+='<div class="body">',e+="<h1>Introducing your one access to everything Kapamilya!</h1>",e+='<p class="sub">Now, you can use one login to access your favorite Kapamilya websites.</p>',e+='<div><img src="//assets.abs-cbn.com/universalnav/img/kapamilya-account.png" alt="Kapamilya Account"></div>',e+='<ul class="hub-container">',e+='<li><span class="hub hub-onemusic"></span></li>',e+='<li><span class="hub starcinema"></span></li>',e+='<li><span class="hub starcreatives"></span></li>',e+='<li><span class="hub hub-mmk"></span></li>',e+="<br>",e+='<li><span class="hub hub-entertainment"></span></li>',e+='<li><span class="hub hub-news"></span></li>',e+='<li><span class="hub hub-sports"></span></li>',e+='<li><span class="hub hub-lifestyle"></span></li>',e+="<br>",e+='<li><span class="hub hub-ktx"></span></li>',e+='<li><span class="hub hub-push"></span></li>',e+='<li><span class="hub hub-kty"></span></li>',e+="</ul>",e+='<p class="text-blue">We will now bring you to kapamilyaaccounts.abs-cbn.com</p>',e+='<p class="btn btn-proceed"><a href="javascript:void(0);">Proceed</a></p>',e+='<p class="btn btn-cancel"><a href="javascript:void(0);" class="btn-cancel">Cancel</a></p>',e+="</div>",e+="</div>",e+="</section>",a("body").append(e)},loginClick:function(e){switch(e){case"news":case"mmk":case"starcinema":case"sports":case"lifestyle":case"push":case"entertainment":case"bmpm":a(".lightbox").show();break;default:l.goToKapamilyaLogin()}},goToKapamilyaLogin:function(){var a=t.dataDomain;""===a&&(a=t.domainKey),window.location.href=t.ssoPageURL+"login?referrerDomain="+a},returnSiteName:function(){return""!==t.domainKey?t.domainKey.toUpperCase():t.dataDomain.toUpperCase()}};a(window).scroll(function(){l.scrollAnimationHeader(a(this))}),a(window).resize(function(){if(a(".login-icon-uninav").html()){var e=a(".login-icon-uninav").offset().left+15;a(".triangle-top, .triangle-bottom").css("left",e+"px")}}),a(document).ready(function(){a(".bookmarked").attr("disabled","disabled")}),a("#header-collapse, .uninav-main").on("mousewheel DOMMouseScroll",function(a){var e=a.originalEvent,n=e.wheelDelta||-e.detail;this.scrollTop+=30*(n<0?1:-1),a.preventDefault()}),n()}}(jQuery);