'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value'in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _typeof=typeof Symbol==='function'&&typeof Symbol.iterator==='symbol'?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==='function'&&obj.constructor===Symbol&&obj!==Symbol.prototype?'symbol':typeof obj};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}(function(){var root=(typeof self==='undefined'?'undefined':_typeof(self))=='object'&&self.self===self&&self||(typeof global==='undefined'?'undefined':_typeof(global))=='object'&&global.global===global&&global||this||{};var previousUnderscore=root._;var ArrayProto=Array.prototype,ObjProto=Object.prototype;var SymbolProto=typeof Symbol!=='undefined'?Symbol.prototype:null;var push=ArrayProto.push,slice=ArrayProto.slice,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty;var nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeCreate=Object.create;var Ctor=function Ctor(){};var _=function _(obj){if(obj instanceof _)return obj;if(!(this instanceof _))return new _(obj);this._wrapped=obj};if(typeof exports!='undefined'&&!exports.nodeType){if(typeof module!='undefined'&&!module.nodeType&&module.exports){exports=module.exports=_}exports._=_}else{root._=_}_.VERSION='1.8.3';var optimizeCb=function optimizeCb(func,context,argCount){if(context===void 0)return func;switch(argCount){case 1:return function(value){return func.call(context,value)};case null:case 3:return function(value,index,collection){return func.call(context,value,index,collection)};case 4:return function(accumulator,value,index,collection){return func.call(context,accumulator,value,index,collection)};}return function(){return func.apply(context,arguments)}};var builtinIteratee;var cb=function cb(value,context,argCount){if(_.iteratee!==builtinIteratee)return _.iteratee(value,context);if(value==null)return _.identity;if(_.isFunction(value))return optimizeCb(value,context,argCount);if(_.isObject(value)&&!_.isArray(value))return _.matcher(value);return _.property(value)};_.iteratee=builtinIteratee=function builtinIteratee(value,context){return cb(value,context,Infinity)};var restArgs=function restArgs(func,startIndex){startIndex=startIndex==null?func.length-1:+startIndex;return function(){var length=Math.max(arguments.length-startIndex,0),rest=Array(length),index=0;for(;index<length;index++){rest[index]=arguments[index+startIndex]}switch(startIndex){case 0:return func.call(this,rest);case 1:return func.call(this,arguments[0],rest);case 2:return func.call(this,arguments[0],arguments[1],rest);}var args=Array(startIndex+1);for(index=0;index<startIndex;index++){args[index]=arguments[index]}args[startIndex]=rest;return func.apply(this,args)}};var baseCreate=function baseCreate(prototype){if(!_.isObject(prototype))return{};if(nativeCreate)return nativeCreate(prototype);Ctor.prototype=prototype;var result=new Ctor;Ctor.prototype=null;return result};var shallowProperty=function shallowProperty(key){return function(obj){return obj==null?void 0:obj[key]}};var deepGet=function deepGet(obj,path){var length=path.length;for(var i=0;i<length;i++){if(obj==null)return void 0;obj=obj[path[i]]}return length?obj:void 0};var MAX_ARRAY_INDEX=Math.pow(2,53)-1;var getLength=shallowProperty('length');var isArrayLike=function isArrayLike(collection){var length=getLength(collection);return typeof length=='number'&&length>=0&&length<=MAX_ARRAY_INDEX};_.each=_.forEach=function(obj,iteratee,context){iteratee=optimizeCb(iteratee,context);var i,length;if(isArrayLike(obj)){for(i=0,length=obj.length;i<length;i++){iteratee(obj[i],i,obj)}}else{var keys=_.keys(obj);for(i=0,length=keys.length;i<length;i++){iteratee(obj[keys[i]],keys[i],obj)}}return obj};_.map=_.collect=function(obj,iteratee,context){iteratee=cb(iteratee,context);var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length,results=Array(length);for(var index=0;index<length;index++){var currentKey=keys?keys[index]:index;results[index]=iteratee(obj[currentKey],currentKey,obj)}return results};var createReduce=function createReduce(dir){var reducer=function reducer(obj,iteratee,memo,initial){var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length,index=dir>0?0:length-1;if(!initial){memo=obj[keys?keys[index]:index];index+=dir}for(;index>=0&&index<length;index+=dir){var currentKey=keys?keys[index]:index;memo=iteratee(memo,obj[currentKey],currentKey,obj)}return memo};return function(obj,iteratee,memo,context){var initial=arguments.length>=3;return reducer(obj,optimizeCb(iteratee,context,4),memo,initial)}};_.reduce=_.foldl=_.inject=createReduce(1);_.reduceRight=_.foldr=createReduce(-1);_.find=_.detect=function(obj,predicate,context){var keyFinder=isArrayLike(obj)?_.findIndex:_.findKey;var key=keyFinder(obj,predicate,context);if(key!==void 0&&key!==-1)return obj[key]};_.filter=_.select=function(obj,predicate,context){var results=[];predicate=cb(predicate,context);_.each(obj,function(value,index,list){if(predicate(value,index,list))results.push(value)});return results};_.reject=function(obj,predicate,context){return _.filter(obj,_.negate(cb(predicate)),context)};_.every=_.all=function(obj,predicate,context){predicate=cb(predicate,context);var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length;for(var index=0;index<length;index++){var currentKey=keys?keys[index]:index;if(!predicate(obj[currentKey],currentKey,obj))return false}return true};_.some=_.any=function(obj,predicate,context){predicate=cb(predicate,context);var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length;for(var index=0;index<length;index++){var currentKey=keys?keys[index]:index;if(predicate(obj[currentKey],currentKey,obj))return true}return false};_.contains=_.includes=_.include=function(obj,item,fromIndex,guard){if(!isArrayLike(obj))obj=_.values(obj);if(typeof fromIndex!='number'||guard)fromIndex=0;return _.indexOf(obj,item,fromIndex)>=0};_.invoke=restArgs(function(obj,path,args){var contextPath,func;if(_.isFunction(path)){func=path}else if(_.isArray(path)){contextPath=path.slice(0,-1);path=path[path.length-1]}return _.map(obj,function(context){var method=func;if(!method){if(contextPath&&contextPath.length){context=deepGet(context,contextPath)}if(context==null)return void 0;method=context[path]}return method==null?method:method.apply(context,args)})});_.pluck=function(obj,key){return _.map(obj,_.property(key))};_.where=function(obj,attrs){return _.filter(obj,_.matcher(attrs))};_.findWhere=function(obj,attrs){return _.find(obj,_.matcher(attrs))};_.max=function(obj,iteratee,context){var result=-Infinity,lastComputed=-Infinity,value,computed;if(iteratee==null||typeof iteratee=='number'&&_typeof(obj[0])!='object'&&obj!=null){obj=isArrayLike(obj)?obj:_.values(obj);for(var i=0,length=obj.length;i<length;i++){value=obj[i];if(value!=null&&value>result){result=value}}}else{iteratee=cb(iteratee,context);_.each(obj,function(v,index,list){computed=iteratee(v,index,list);if(computed>lastComputed||computed===-Infinity&&result===-Infinity){result=v;lastComputed=computed}})}return result};_.min=function(obj,iteratee,context){var result=Infinity,lastComputed=Infinity,value,computed;if(iteratee==null||typeof iteratee=='number'&&_typeof(obj[0])!='object'&&obj!=null){obj=isArrayLike(obj)?obj:_.values(obj);for(var i=0,length=obj.length;i<length;i++){value=obj[i];if(value!=null&&value<result){result=value}}}else{iteratee=cb(iteratee,context);_.each(obj,function(v,index,list){computed=iteratee(v,index,list);if(computed<lastComputed||computed===Infinity&&result===Infinity){result=v;lastComputed=computed}})}return result};_.shuffle=function(obj){return _.sample(obj,Infinity)};_.sample=function(obj,n,guard){if(n==null||guard){if(!isArrayLike(obj))obj=_.values(obj);return obj[_.random(obj.length-1)]}var sample=isArrayLike(obj)?_.clone(obj):_.values(obj);var length=getLength(sample);n=Math.max(Math.min(n,length),0);var last=length-1;for(var index=0;index<n;index++){var rand=_.random(index,last);var temp=sample[index];sample[index]=sample[rand];sample[rand]=temp}return sample.slice(0,n)};_.sortBy=function(obj,iteratee,context){var index=0;iteratee=cb(iteratee,context);return _.pluck(_.map(obj,function(value,key,list){return{value:value,index:index++,criteria:iteratee(value,key,list)}}).sort(function(left,right){var a=left.criteria;var b=right.criteria;if(a!==b){if(a>b||a===void 0)return 1;if(a<b||b===void 0)return-1}return left.index-right.index}),'value')};var group=function group(behavior,partition){return function(obj,iteratee,context){var result=partition?[[],[]]:{};iteratee=cb(iteratee,context);_.each(obj,function(value,index){var key=iteratee(value,index,obj);behavior(result,value,key)});return result}};_.groupBy=group(function(result,value,key){if(_.has(result,key))result[key].push(value);else result[key]=[value]});_.indexBy=group(function(result,value,key){result[key]=value});_.countBy=group(function(result,value,key){if(_.has(result,key))result[key]++;else result[key]=1});var reStrSymbol=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;_.toArray=function(obj){if(!obj)return[];if(_.isArray(obj))return slice.call(obj);if(_.isString(obj)){return obj.match(reStrSymbol)}if(isArrayLike(obj))return _.map(obj,_.identity);return _.values(obj)};_.size=function(obj){if(obj==null)return 0;return isArrayLike(obj)?obj.length:_.keys(obj).length};_.partition=group(function(result,value,pass){result[pass?0:1].push(value)},true);_.first=_.head=_.take=function(array,n,guard){if(array==null||array.length<1)return void 0;if(n==null||guard)return array[0];return _.initial(array,array.length-n)};_.initial=function(array,n,guard){return slice.call(array,0,Math.max(0,array.length-(n==null||guard?1:n)))};_.last=function(array,n,guard){if(array==null||array.length<1)return void 0;if(n==null||guard)return array[array.length-1];return _.rest(array,Math.max(0,array.length-n))};_.rest=_.tail=_.drop=function(array,n,guard){return slice.call(array,n==null||guard?1:n)};_.compact=function(array){return _.filter(array,Boolean)};var flatten=function flatten(input,shallow,strict,output){output=output||[];var idx=output.length;for(var i=0,length=getLength(input);i<length;i++){var value=input[i];if(isArrayLike(value)&&(_.isArray(value)||_.isArguments(value))){if(shallow){var j=0,len=value.length;while(j<len){output[idx++]=value[j++]}}else{flatten(value,shallow,strict,output);idx=output.length}}else if(!strict){output[idx++]=value}}return output};_.flatten=function(array,shallow){return flatten(array,shallow,false)};_.without=restArgs(function(array,otherArrays){return _.difference(array,otherArrays)});_.uniq=_.unique=function(array,isSorted,iteratee,context){if(!_.isBoolean(isSorted)){context=iteratee;iteratee=isSorted;isSorted=false}if(iteratee!=null)iteratee=cb(iteratee,context);var result=[];var seen=[];for(var i=0,length=getLength(array);i<length;i++){var value=array[i],computed=iteratee?iteratee(value,i,array):value;if(isSorted){if(!i||seen!==computed)result.push(value);seen=computed}else if(iteratee){if(!_.contains(seen,computed)){seen.push(computed);result.push(value)}}else if(!_.contains(result,value)){result.push(value)}}return result};_.union=restArgs(function(arrays){return _.uniq(flatten(arrays,true,true))});_.intersection=function(array){var result=[];var argsLength=arguments.length;for(var i=0,length=getLength(array);i<length;i++){var item=array[i];if(_.contains(result,item))continue;var j;for(j=1;j<argsLength;j++){if(!_.contains(arguments[j],item))break}if(j===argsLength)result.push(item)}return result};_.difference=restArgs(function(array,rest){rest=flatten(rest,true,true);return _.filter(array,function(value){return!_.contains(rest,value)})});_.unzip=function(array){var length=array&&_.max(array,getLength).length||0;var result=Array(length);for(var index=0;index<length;index++){result[index]=_.pluck(array,index)}return result};_.zip=restArgs(_.unzip);_.object=function(list,values){var result={};for(var i=0,length=getLength(list);i<length;i++){if(values){result[list[i]]=values[i]}else{result[list[i][0]]=list[i][1]}}return result};var createPredicateIndexFinder=function createPredicateIndexFinder(dir){return function(array,predicate,context){predicate=cb(predicate,context);var length=getLength(array);var index=dir>0?0:length-1;for(;index>=0&&index<length;index+=dir){if(predicate(array[index],index,array))return index}return-1}};_.findIndex=createPredicateIndexFinder(1);_.findLastIndex=createPredicateIndexFinder(-1);_.sortedIndex=function(array,obj,iteratee,context){iteratee=cb(iteratee,context,1);var value=iteratee(obj);var low=0,high=getLength(array);while(low<high){var mid=Math.floor((low+high)/2);if(iteratee(array[mid])<value)low=mid+1;else high=mid}return low};var createIndexFinder=function createIndexFinder(dir,predicateFind,sortedIndex){return function(array,item,idx){var i=0,length=getLength(array);if(typeof idx=='number'){if(dir>0){i=idx>=0?idx:Math.max(idx+length,i)}else{length=idx>=0?Math.min(idx+1,length):idx+length+1}}else if(sortedIndex&&idx&&length){idx=sortedIndex(array,item);return array[idx]===item?idx:-1}if(item!==item){idx=predicateFind(slice.call(array,i,length),_.isNaN);return idx>=0?idx+i:-1}for(idx=dir>0?i:length-1;idx>=0&&idx<length;idx+=dir){if(array[idx]===item)return idx}return-1}};_.indexOf=createIndexFinder(1,_.findIndex,_.sortedIndex);_.lastIndexOf=createIndexFinder(-1,_.findLastIndex);_.range=function(start,stop,step){if(stop==null){stop=start||0;start=0}if(!step){step=stop<start?-1:1}var length=Math.max(Math.ceil((stop-start)/step),0);var range=Array(length);for(var idx=0;idx<length;idx++,start+=step){range[idx]=start}return range};_.chunk=function(array,count){if(count==null||count<1)return[];var result=[];var i=0,length=array.length;while(i<length){result.push(slice.call(array,i,i+=count))}return result};var executeBound=function executeBound(sourceFunc,boundFunc,context,callingContext,args){if(!(callingContext instanceof boundFunc))return sourceFunc.apply(context,args);var self=baseCreate(sourceFunc.prototype);var result=sourceFunc.apply(self,args);if(_.isObject(result))return result;return self};_.bind=restArgs(function(func,context,args){if(!_.isFunction(func))throw new TypeError('Bind must be called on a function');var bound=restArgs(function(callArgs){return executeBound(func,bound,context,this,args.concat(callArgs))});return bound});_.partial=restArgs(function(func,boundArgs){var placeholder=_.partial.placeholder;var bound=function bound(){var position=0,length=boundArgs.length;var args=Array(length);for(var i=0;i<length;i++){args[i]=boundArgs[i]===placeholder?arguments[position++]:boundArgs[i]}while(position<arguments.length){args.push(arguments[position++])}return executeBound(func,bound,this,this,args)};return bound});_.partial.placeholder=_;_.bindAll=restArgs(function(obj,keys){keys=flatten(keys,false,false);var index=keys.length;if(index<1)throw new Error('bindAll must be passed function names');while(index--){var key=keys[index];obj[key]=_.bind(obj[key],obj)}});_.memoize=function(func,hasher){var memoize=function memoize(key){var cache=memoize.cache;var address=''+(hasher?hasher.apply(this,arguments):key);if(!_.has(cache,address))cache[address]=func.apply(this,arguments);return cache[address]};memoize.cache={};return memoize};_.delay=restArgs(function(func,wait,args){return setTimeout(function(){return func.apply(null,args)},wait)});_.defer=_.partial(_.delay,_,1);_.throttle=function(func,wait,options){var timeout,context,args,result;var previous=0;if(!options)options={};var later=function later(){previous=options.leading===false?0:_.now();timeout=null;result=func.apply(context,args);if(!timeout)context=args=null};var throttled=function throttled(){var now=_.now();if(!previous&&options.leading===false)previous=now;var remaining=wait-(now-previous);context=this;args=arguments;if(remaining<=0||remaining>wait){if(timeout){clearTimeout(timeout);timeout=null}previous=now;result=func.apply(context,args);if(!timeout)context=args=null}else if(!timeout&&options.trailing!==false){timeout=setTimeout(later,remaining)}return result};throttled.cancel=function(){clearTimeout(timeout);previous=0;timeout=context=args=null};return throttled};_.debounce=function(func,wait,immediate){var timeout,result;var later=function later(context,args){timeout=null;if(args)result=func.apply(context,args)};var debounced=restArgs(function(args){if(timeout)clearTimeout(timeout);if(immediate){var callNow=!timeout;timeout=setTimeout(later,wait);if(callNow)result=func.apply(this,args)}else{timeout=_.delay(later,wait,this,args)}return result});debounced.cancel=function(){clearTimeout(timeout);timeout=null};return debounced};_.wrap=function(func,wrapper){return _.partial(wrapper,func)};_.negate=function(predicate){return function(){return!predicate.apply(this,arguments)}};_.compose=function(){var args=arguments;var start=args.length-1;return function(){var i=start;var result=args[start].apply(this,arguments);while(i--){result=args[i].call(this,result)}return result}};_.after=function(times,func){return function(){if(--times<1){return func.apply(this,arguments)}}};_.before=function(times,func){var memo;return function(){if(--times>0){memo=func.apply(this,arguments)}if(times<=1)func=null;return memo}};_.once=_.partial(_.before,2);_.restArgs=restArgs;var hasEnumBug=!{toString:null}.propertyIsEnumerable('toString');var nonEnumerableProps=['valueOf','isPrototypeOf','toString','propertyIsEnumerable','hasOwnProperty','toLocaleString'];var collectNonEnumProps=function collectNonEnumProps(obj,keys){var nonEnumIdx=nonEnumerableProps.length;var constructor=obj.constructor;var proto=_.isFunction(constructor)&&constructor.prototype||ObjProto;var prop='constructor';if(_.has(obj,prop)&&!_.contains(keys,prop))keys.push(prop);while(nonEnumIdx--){prop=nonEnumerableProps[nonEnumIdx];if(prop in obj&&obj[prop]!==proto[prop]&&!_.contains(keys,prop)){keys.push(prop)}}};_.keys=function(obj){if(!_.isObject(obj))return[];if(nativeKeys)return nativeKeys(obj);var keys=[];for(var key in obj){if(_.has(obj,key))keys.push(key)}if(hasEnumBug)collectNonEnumProps(obj,keys);return keys};_.allKeys=function(obj){if(!_.isObject(obj))return[];var keys=[];for(var key in obj){keys.push(key)}if(hasEnumBug)collectNonEnumProps(obj,keys);return keys};_.values=function(obj){var keys=_.keys(obj);var length=keys.length;var values=Array(length);for(var i=0;i<length;i++){values[i]=obj[keys[i]]}return values};_.mapObject=function(obj,iteratee,context){iteratee=cb(iteratee,context);var keys=_.keys(obj),length=keys.length,results={};for(var index=0;index<length;index++){var currentKey=keys[index];results[currentKey]=iteratee(obj[currentKey],currentKey,obj)}return results};_.pairs=function(obj){var keys=_.keys(obj);var length=keys.length;var pairs=Array(length);for(var i=0;i<length;i++){pairs[i]=[keys[i],obj[keys[i]]]}return pairs};_.invert=function(obj){var result={};var keys=_.keys(obj);for(var i=0,length=keys.length;i<length;i++){result[obj[keys[i]]]=keys[i]}return result};_.functions=_.methods=function(obj){var names=[];for(var key in obj){if(_.isFunction(obj[key]))names.push(key)}return names.sort()};var createAssigner=function createAssigner(keysFunc,defaults){return function(obj){var length=arguments.length;if(defaults)obj=Object(obj);if(length<2||obj==null)return obj;for(var index=1;index<length;index++){var source=arguments[index],keys=keysFunc(source),l=keys.length;for(var i=0;i<l;i++){var key=keys[i];if(!defaults||obj[key]===void 0)obj[key]=source[key]}}return obj}};_.extend=createAssigner(_.allKeys);_.extendOwn=_.assign=createAssigner(_.keys);_.findKey=function(obj,predicate,context){predicate=cb(predicate,context);var keys=_.keys(obj),key;for(var i=0,length=keys.length;i<length;i++){key=keys[i];if(predicate(obj[key],key,obj))return key}};var keyInObj=function keyInObj(value,key,obj){return key in obj};_.pick=restArgs(function(obj,keys){var result={},iteratee=keys[0];if(obj==null)return result;if(_.isFunction(iteratee)){if(keys.length>1)iteratee=optimizeCb(iteratee,keys[1]);keys=_.allKeys(obj)}else{iteratee=keyInObj;keys=flatten(keys,false,false);obj=Object(obj)}for(var i=0,length=keys.length;i<length;i++){var key=keys[i];var value=obj[key];if(iteratee(value,key,obj))result[key]=value}return result});_.omit=restArgs(function(obj,keys){var iteratee=keys[0],context;if(_.isFunction(iteratee)){iteratee=_.negate(iteratee);if(keys.length>1)context=keys[1]}else{keys=_.map(flatten(keys,false,false),String);iteratee=function iteratee(value,key){return!_.contains(keys,key)}}return _.pick(obj,iteratee,context)});_.defaults=createAssigner(_.allKeys,true);_.create=function(prototype,props){var result=baseCreate(prototype);if(props)_.extendOwn(result,props);return result};_.clone=function(obj){if(!_.isObject(obj))return obj;return _.isArray(obj)?obj.slice():_.extend({},obj)};_.tap=function(obj,interceptor){interceptor(obj);return obj};_.isMatch=function(object,attrs){var keys=_.keys(attrs),length=keys.length;if(object==null)return!length;var obj=Object(object);for(var i=0;i<length;i++){var key=keys[i];if(attrs[key]!==obj[key]||!(key in obj))return false}return true};var eq,deepEq;eq=function eq(a,b,aStack,bStack){if(a===b)return a!==0||1/a===1/b;if(a==null||b==null)return false;if(a!==a)return b!==b;var type=typeof a==='undefined'?'undefined':_typeof(a);if(type!=='function'&&type!=='object'&&(typeof b==='undefined'?'undefined':_typeof(b))!='object')return false;return deepEq(a,b,aStack,bStack)};deepEq=function deepEq(a,b,aStack,bStack){if(a instanceof _)a=a._wrapped;if(b instanceof _)b=b._wrapped;var className=toString.call(a);if(className!==toString.call(b))return false;switch(className){case'[object RegExp]':case'[object String]':return''+a===''+b;case'[object Number]':if(+a!==+a)return+b!==+b;return+a===0?1/+a===1/b:+a===+b;case'[object Date]':case'[object Boolean]':return+a===+b;case'[object Symbol]':return SymbolProto.valueOf.call(a)===SymbolProto.valueOf.call(b);}var areArrays=className==='[object Array]';if(!areArrays){if((typeof a==='undefined'?'undefined':_typeof(a))!='object'||(typeof b==='undefined'?'undefined':_typeof(b))!='object')return false;var aCtor=a.constructor,bCtor=b.constructor;if(aCtor!==bCtor&&!(_.isFunction(aCtor)&&aCtor instanceof aCtor&&_.isFunction(bCtor)&&bCtor instanceof bCtor)&&'constructor'in a&&'constructor'in b){return false}}aStack=aStack||[];bStack=bStack||[];var length=aStack.length;while(length--){if(aStack[length]===a)return bStack[length]===b}aStack.push(a);bStack.push(b);if(areArrays){length=a.length;if(length!==b.length)return false;while(length--){if(!eq(a[length],b[length],aStack,bStack))return false}}else{var keys=_.keys(a),key;length=keys.length;if(_.keys(b).length!==length)return false;while(length--){key=keys[length];if(!(_.has(b,key)&&eq(a[key],b[key],aStack,bStack)))return false}}aStack.pop();bStack.pop();return true};_.isEqual=function(a,b){return eq(a,b)};_.isEmpty=function(obj){if(obj==null)return true;if(isArrayLike(obj)&&(_.isArray(obj)||_.isString(obj)||_.isArguments(obj)))return obj.length===0;return _.keys(obj).length===0};_.isElement=function(obj){return!!(obj&&obj.nodeType===1)};_.isArray=nativeIsArray||function(obj){return toString.call(obj)==='[object Array]'};_.isObject=function(obj){var type=typeof obj==='undefined'?'undefined':_typeof(obj);return type==='function'||type==='object'&&!!obj};_.each(['Arguments','Function','String','Number','Date','RegExp','Error','Symbol','Map','WeakMap','Set','WeakSet'],function(name){_['is'+name]=function(obj){return toString.call(obj)==='[object '+name+']'}});if(!_.isArguments(arguments)){_.isArguments=function(obj){return _.has(obj,'callee')}}var nodelist=root.document&&root.document.childNodes;if(typeof /./!='function'&&(typeof Int8Array==='undefined'?'undefined':_typeof(Int8Array))!='object'&&typeof nodelist!='function'){_.isFunction=function(obj){return typeof obj=='function'||false}}_.isFinite=function(obj){return!_.isSymbol(obj)&&isFinite(obj)&&!isNaN(parseFloat(obj))};_.isNaN=function(obj){return _.isNumber(obj)&&isNaN(obj)};_.isBoolean=function(obj){return obj===true||obj===false||toString.call(obj)==='[object Boolean]'};_.isNull=function(obj){return obj===null};_.isUndefined=function(obj){return obj===void 0};_.has=function(obj,path){if(!_.isArray(path)){return obj!=null&&hasOwnProperty.call(obj,path)}var length=path.length;for(var i=0;i<length;i++){var key=path[i];if(obj==null||!hasOwnProperty.call(obj,key)){return false}obj=obj[key]}return!!length};_.noConflict=function(){root._=previousUnderscore;return this};_.identity=function(value){return value};_.constant=function(value){return function(){return value}};_.noop=function(){};_.property=function(path){if(!_.isArray(path)){return shallowProperty(path)}return function(obj){return deepGet(obj,path)}};_.propertyOf=function(obj){if(obj==null){return function(){}}return function(path){return!_.isArray(path)?obj[path]:deepGet(obj,path)}};_.matcher=_.matches=function(attrs){attrs=_.extendOwn({},attrs);return function(obj){return _.isMatch(obj,attrs)}};_.times=function(n,iteratee,context){var accum=Array(Math.max(0,n));iteratee=optimizeCb(iteratee,context,1);for(var i=0;i<n;i++){accum[i]=iteratee(i)}return accum};_.random=function(min,max){if(max==null){max=min;min=0}return min+Math.floor(Math.random()*(max-min+1))};_.now=Date.now||function(){return new Date().getTime()};var escapeMap={'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;','\'':'&#x27;','`':'&#x60;'};var unescapeMap=_.invert(escapeMap);var createEscaper=function createEscaper(map){var escaper=function escaper(match){return map[match]};var source='(?:'+_.keys(map).join('|')+')';var testRegexp=RegExp(source);var replaceRegexp=RegExp(source,'g');return function(string){string=string==null?'':''+string;return testRegexp.test(string)?string.replace(replaceRegexp,escaper):string}};_.escape=createEscaper(escapeMap);_.unescape=createEscaper(unescapeMap);_.result=function(obj,path,fallback){if(!_.isArray(path))path=[path];var length=path.length;if(!length){return _.isFunction(fallback)?fallback.call(obj):fallback}for(var i=0;i<length;i++){var prop=obj==null?void 0:obj[path[i]];if(prop===void 0){prop=fallback;i=length}obj=_.isFunction(prop)?prop.call(obj):prop}return obj};var idCounter=0;_.uniqueId=function(prefix){var id=++idCounter+'';return prefix?prefix+id:id};_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var noMatch=/(.)^/;var escapes={'\'':'\'','\\':'\\','\r':'r','\n':'n','\u2028':'u2028','\u2029':'u2029'};var escapeRegExp=/\\|'|\r|\n|\u2028|\u2029/g;var escapeChar=function escapeChar(match){return'\\'+escapes[match]};_.template=function(text,settings,oldSettings){if(!settings&&oldSettings)settings=oldSettings;settings=_.defaults({},settings,_.templateSettings);var matcher=RegExp([(settings.escape||noMatch).source,(settings.interpolate||noMatch).source,(settings.evaluate||noMatch).source].join('|')+'|$','g');var index=0;var source='__p+=\'';text.replace(matcher,function(match,escape,interpolate,evaluate,offset){source+=text.slice(index,offset).replace(escapeRegExp,escapeChar);index=offset+match.length;if(escape){source+='\'+\n((__t=('+escape+'))==null?\'\':_.escape(__t))+\n\''}else if(interpolate){source+='\'+\n((__t=('+interpolate+'))==null?\'\':__t)+\n\''}else if(evaluate){source+='\';\n'+evaluate+'\n__p+=\''}return match});source+='\';\n';if(!settings.variable)source='with(obj||{}){\n'+source+'}\n';source='var __t,__p=\'\',__j=Array.prototype.join,'+'print=function(){__p+=__j.call(arguments,\'\');};\n'+source+'return __p;\n';var render;try{render=new Function(settings.variable||'obj','_',source)}catch(e){e.source=source;throw e}var template=function template(data){return render.call(this,data,_)};var argument=settings.variable||'obj';template.source='function('+argument+'){\n'+source+'}';return template};_.chain=function(obj){var instance=_(obj);instance._chain=true;return instance};var chainResult=function chainResult(instance,obj){return instance._chain?_(obj).chain():obj};_.mixin=function(obj){_.each(_.functions(obj),function(name){var func=_[name]=obj[name];_.prototype[name]=function(){var args=[this._wrapped];push.apply(args,arguments);return chainResult(this,func.apply(_,args))}});return _};_.mixin(_);_.each(['pop','push','reverse','shift','sort','splice','unshift'],function(name){var method=ArrayProto[name];_.prototype[name]=function(){var obj=this._wrapped;method.apply(obj,arguments);if((name==='shift'||name==='splice')&&obj.length===0)delete obj[0];return chainResult(this,obj)}});_.each(['concat','join','slice'],function(name){var method=ArrayProto[name];_.prototype[name]=function(){return chainResult(this,method.apply(this._wrapped,arguments))}});_.prototype.value=function(){return this._wrapped};_.prototype.valueOf=_.prototype.toJSON=_.prototype.value;_.prototype.toString=function(){return String(this._wrapped)};if(typeof define=='function'&&define.amd){define('underscore',[],function(){return _})}})();var EventBus=function(){function EventBus($){var d3=arguments.length>1&&arguments[1]!==undefined?arguments[1]:window.Deltatre;_classCallCheck(this,EventBus);this.listeners=[];this.jq=$;this.trace=d3.Trace}_createClass(EventBus,[{key:'clear',value:function clear(){this.listeners=[]}},{key:'on',value:function on(key,callback,context){var _this2=this;if(!key){throw new Error('key must not be null')}if(!callback){throw new Error('callback must not be null')}if(Array.isArray(key)){return key.forEach(function(k){return _this2.on(k,callback,context)})}var args=arguments.length>3?Array.prototype.splice.apply(arguments,[3,arguments.length-1]):[];var listener={key:key,callback:callback,context:context,args:args};if(this.listeners.some(function(l){return l.key===key&&l.callback.toString()===callback.toString()&&args&&l.args.toString()===args.toString()&&context&&Object.is(l.context,context)}))return;this.listeners.push(listener)}},{key:'off',value:function off(key,callback,context){if(!key){throw new Error('key must not be null')}if(!this.listeners||!this.listeners.length){return false}this.listeners=this.listeners.filter(function(listener){return listener.key!==key||callback&&listener.callback.toString()!==callback.toString()||context&&!Object.is(listener.context,context)});return this.listeners&&this.listeners.some(function(l){return l.key===key})}},{key:'dispatch',value:function dispatch(key){var _this3=this;if(!key){throw new Error('key must not be null')}var listeners=this.listeners.filter(function(l){return l.key===key});if(!listeners||!listeners.length){return false}var args=Array.prototype.slice.call(arguments);args=args.length>1?args.splice(1,args.length-1):[];var data=this.jq.extend(true,[],args);listeners.forEach(function(listener){try{listener.callback.apply(listener.context,data)}catch(e){_this3.trace(e,listener,data)}});return true}},{key:'anybody',value:function anybody(key){if(!key){throw new Error('key must not be null')}return this.listeners.some(function(l){return l.key===key})}}]);return EventBus}();(function($,win){win.Deltatre=win.Deltatre||{};var d3=win.Deltatre;d3.eventBus=d3.eventBus||new EventBus($,d3);var listener=function listener(event){var origin=event.origin||event.originalEvent.origin;if(!origin.includes('uefa.com'))return;if(event.data.key)d3.eventBus.dispatch(event.data.key,event.data.content)};if(win.addEventListener){win.addEventListener('message',listener,false)}else{win.attachEvent('onmessage',listener)}})(jQuery,window);var Cookie=function(){function Cookie(){_classCallCheck(this,Cookie)}_createClass(Cookie,null,[{key:'set',value:function set(name,value,expires,path,domain,secure){var today=new Date;today.setTime(today.getTime());if(expires){expires=expires*1000*60*60*24}var expiresDate=new Date(today.getTime()+expires);var d=domain?';domain='+domain:this.cookieDomain&&this.cookieDomain!==''?';domain='+this.cookieDomain:'';document.cookie=name+'='+encodeURIComponent(value)+(expires?';expires='+expiresDate.toGMTString():'')+(path?';path='+path:';path='+'/')+d+(secure?';secure':'')}},{key:'setObject',value:function setObject(name,value,expires,path,domain,secure){this.set(name,JSON.stringify(value),expires,path,domain,secure)}},{key:'get',value:function get(name,doUnescape){if(typeof doUnescape=='undefined')doUnescape=true;var cookie=document.cookie.match(new RegExp('(^|;)\\s*'+encodeURIComponent(name)+'=([^;\\s]*)'));return cookie?doUnescape?decodeURIComponent(cookie[2]):cookie[2]:null}},{key:'getObject',value:function getObject(name,doUnescape){return JSON.parse(this.get(name,doUnescape))}},{key:'erase',value:function erase(name,path,domain,secure){Cookie.set(name,'',-1,path,domain,secure)}},{key:'accept',value:function accept(){if(typeof navigator.cookieEnabled=='boolean'){return navigator.cookieEnabled}Cookie.set('_test','1');return Cookie.erase('_test')==='1'}}]);return Cookie}();function User(){this.cookieName='uefa_login';this.cookieNameUclf='uclf';this.ckLogOrigin='uefa__ckLogOrigin';this.ckRegOrigin='uefa__ckRegOrigin';this.cookieDomain='.uefa.com';this.Data=null;this.isLogged=function(){var a=Cookie.get(this.cookieName);if(a===undefined||a===null||a===''){return false}return true};this.loadData=function(){if(this.isLogged()){this.Data=this.cookieStrDecode(Cookie.get(this.cookieName,true))}};this.cookieStrDecode=function(s,separator){var _o={};if(!s)return _o;if(!separator)separator='&';var _vs=s.split(separator);for(var i=0,l=_vs.length;i<l;i++){var ivs=_vs[i].split('=');_o[ivs[0]]=decodeURIComponent(ivs[1].toString())}return _o};this.logout=function(){history.go(0)};this.logoutNoRedirect=function(){Cookie.set(this.cookieName,'',-1,'/',this.cookieDomain);var a=Cookie.get(this.cookieNameUclf);if(a===undefined||a===null||a==='null'){Cookie.set(this.cookieNameUclf,'',-1,'/','.uclfantasy'+this.cookieDomain);Cookie.erase(this.cookieNameUclf)}};this.loadData()}function HeaderScript($){this.currentUser=null;this.setUserHeader=function(legacy){var popupStyle='status=0, menubar=0, toolbar=0, location=0, scrollbars=0, resizable=0';var _this=this;var domain=window.Deltatre.loginHandler.url;var legacyLogin=$('.login2');legacy=legacy||legacyLogin&&legacyLogin.length;if(_this.currentUser&&_this.currentUser.isLogged()){if(!_this.currentUser.Data)_this.currentUser.loadData();var username='';if(_this.currentUser.Data){if(_this.currentUser.Data.ScreenName&&_this.currentUser.Data.ScreenName.length)username=_this.currentUser.Data.ScreenName;else username=_this.currentUser.Data.UserEMail.split('@')[0]}if(username&&username.length>24){username=username.substring(0,24)+'...'}var returnUrl='';if(!legacy){var tmp=document.getElementById('uefa-username');var isPrd=location.hostname.indexOf('.stg.irt.uefa.')===-1&&location.hostname.indexOf('.stg.infra.uefa.')===-1&&location.hostname.indexOf('localhost')===-1;tmp.innerHTML=username;tmp=document.getElementById('uefa-logged-profile');tmp.setAttribute('href',domain+'/Profile');tmp=document.getElementById('uefa-logged-logout');returnUrl=tmp.getAttribute('data-return');returnUrl=returnUrl&&returnUrl.length?returnUrl:window.location.href;returnUrl=!isPrd&&returnUrl.startsWith('//')?'http:'+returnUrl:returnUrl;$('#uefa-logged #uefa-logged-logout').off('click').on('click',function(e){e.preventDefault();window.open(domain+'/account/logoff?returnurl='+returnUrl+'%3Forigin='+window.location.origin+'%23closeandreload','loginpopup',popupStyle+', width=1, height=1, top=10, left=10');window.focus();if(!!window.MSInputMethodContext&&!!document.documentMode){setTimeout(function(){window.postMessage({key:'userLogged'},window.location.origin)},2000)}return false});tmp.setAttribute('href',domain+'/account/logoff?returnurl='+encodeURI(window.location.href));tmp=document.getElementById('uefa-logged-account');tmp.setAttribute('href',domain+'/Profile/AccountSettings');tmp=document.getElementById('uefa-logged-pref');tmp.setAttribute('href',domain+'/Profile/PreferencesSettings');document.getElementById('uefa-logged').style.display='block';document.getElementById('uefa-login').style.display='none'}else{$('.loggedUserSpan').attr('href',domain+'/Profile').attr('title',username).attr('class','hdr-lnk').text(username).append('<span class=\'hdr-arrow hdr-arrow-white\'>&nbsp;</span>');var tmp2=document.getElementById('logoutHL');returnUrl=tmp2.getAttribute('data-return');returnUrl=returnUrl&&returnUrl.length?returnUrl:window.location.href;$('#logged2 #logoutHL').off('click').on('click',function(e){e.preventDefault();window.open(domain+'/account/logoff?returnurl='+returnUrl+'%3Forigin='+window.location.origin+'%23closeandreload','loginpopup',popupStyle+', width=1, height=1, top=10, left=10');window.focus();return false});tmp2.setAttribute('href',domain+'/account/logoff?returnurl='+encodeURI(window.location.href));tmp2=document.getElementById('loggedAccount');tmp2.setAttribute('href',domain+'/Profile/AccountSettings');tmp2=document.getElementById('loggedPref');tmp2.setAttribute('href',domain+'/Profile/PreferencesSettings');document.getElementById('loggedH').style.display='block';document.getElementById('registerH').style.display='none';document.getElementById('loginH').style.display='none';document.getElementById('login2').style.display='none';if(document.getElementById('logged2')){document.getElementById('logged2').style.display='none'}}}else{if(!legacy){document.getElementById('uefa-logged').style.display='none';document.getElementById('uefa-login').style.display='block'}else{document.getElementById('loggedH').style.display='none';document.getElementById('registerH').style.display='block';document.getElementById('loginH').style.display='block';document.getElementById('login2').style.display='none';if(document.getElementById('logged2')){document.getElementById('logged2').style.display='none'}}}};this.logout=function(){if(typeof this.currentUser!=='undefined'&&this.currentUser.isLogged()){this.currentUser.logout()}this.setUserHeader()};this.myInit=function(){this.currentUser=new User;if(document.getElementById('uefa-logged')&&document.getElementById('uefa-login')){this.setUserHeader()}else if(document.getElementById('loggedH')&&document.getElementById('registerH')&&document.getElementById('loginH')){this.setUserHeader(true)}};this.myInit()}(function(win,$){'use strict';var d3=win.Deltatre;$(document).ready(function(){if(typeof win.LoginHeader=='undefined'){win.LoginHeader=new HeaderScript($)}d3.eventBus.on('userLogged',win.LoginHeader.myInit,win.LoginHeader)})})(window,jQuery);var LoginLazyLoader=function(){function LoginLazyLoader(){_classCallCheck(this,LoginLazyLoader);this.defaults={isInitialized:null,initialize:null,callback:null}}_createClass(LoginLazyLoader,[{key:'load',value:function load(parameters){var opts=jQuery.extend({},this.defaults,parameters);if(opts.isInitialized()){opts.callback()}else{opts.initialize(opts.callback)}}}]);return LoginLazyLoader}();var JsBootstrapper=function(){function JsBootstrapper(remote){_classCallCheck(this,JsBootstrapper);this.remote=remote;this.lazyLoader=new LoginLazyLoader}_createClass(JsBootstrapper,[{key:'getCached',value:function getCached(url,success){var options={dataType:'script',cache:true,url:url,success:success};return jQuery.ajax(options)}},{key:'isHostObject',value:function isHostObject(object,property){return!!(_typeof(object[property])=='object'&&object[property])}},{key:'afterJson2IsLoaded',value:function afterJson2IsLoaded(callback){var _this4=this;this.lazyLoader.load({isInitialized:function isInitialized(){return _this4.isHostObject(window,'JSON')},initialize:function initialize(done){_this4.getCached(_this4.remote+'/easyxdm/json2.js',function(){done()})},callback:callback})}},{key:'jsLoaded',value:function jsLoaded(callback){var _this5=this;this.afterJson2IsLoaded(function(){_this5.lazyLoader.load({isInitialized:function isInitialized(){if(typeof easyXDM==='undefined'){return false}return true},initialize:function initialize(done){_this5.getCached(_this5.remote+'/easyxdm/easyxdm.js',function(){done()})},callback:callback})})}},{key:'jsInitialized',value:function jsInitialized(callback){var _this6=this;this.lazyLoader.load({isInitialized:function isInitialized(){if(_this6.xhr){return true}return false},initialize:function initialize(done){_this6.xhr=new easyXDM.Rpc({method:'POST',local:'../easyxdm/name.html',swf:_this6.remote+'/easyxdm/easyxdm.swf',remote:_this6.remote+'/easyxdm/cors/',remoteHelper:_this6.remote+'/easyxdm/name.html'},{remote:{request:{}}});done()},callback:callback})}}]);return JsBootstrapper}();var LoginHandler=function(){function LoginHandler(win,$,Cookie){_classCallCheck(this,LoginHandler);this.win=win;this.Cookie=Cookie;var isPrd=location.hostname.indexOf('.stg.irt.uefa.')===-1&&location.hostname.indexOf('.stg.infra.uefa.')===-1&&location.hostname.indexOf('localhost')===-1;var baseUrl=(isPrd?'https://':'http://')+(isPrd?'user':'user-pre')+'.uefa.com';this.JsBootstrapper=new JsBootstrapper(baseUrl);var lang=$('html').data('lang')||'en';this.url=baseUrl+'/'+lang;if(window.location.hash==='#_=_')window.location.hash=''}_createClass(LoginHandler,[{key:'doLogin',value:function doLogin(email,password,rememberMe,onSuccess,onError){var _this7=this;this.JsBootstrapper.jsLoaded(function(){_this7.JsBootstrapper.jsInitialized(function(){_this7.JsBootstrapper.xhr.request({url:_this7.url+'/Account/LogOn',method:'POST',headers:{'Login-Type':'Ajax','Remote-Origin':window.location.protocol+'//'+window.location.host},data:{Email:email,Password:password,RememberMe:rememberMe},timeout:30*1000},function(xsuccess){return _this7.onSuccessHandler(xsuccess,onSuccess,onError)},function(err){return onError(err)})})})}},{key:'onSuccessHandler',value:function onSuccessHandler(xsuccess,onSuccess,onError){var uefaCookie=xsuccess.headers['Uefa-Cookie']||xsuccess.headers['uefa-cookie'];if(uefaCookie){uefaCookie=eval('('+uefaCookie+')');this.Cookie.set(uefaCookie[0].cookieName,uefaCookie[0].cookieValue,uefaCookie[0].cookieOptions.expires,uefaCookie[0].cookieOptions.path,uefaCookie[0].cookieOptions.domain,false);this.Cookie.set(uefaCookie[1].cookieName,uefaCookie[1].cookieValue,uefaCookie[1].cookieOptions.expires,uefaCookie[1].cookieOptions.path,uefaCookie[1].cookieOptions.domain,false);xsuccess.returnUrl=uefaCookie[0].returnUrl;onSuccess(xsuccess)}else{var err=new Object;var uefaError=xsuccess.headers['Uefa-Error']||xsuccess.headers['uefa-error'];if(uefaError){uefaError=eval('('+uefaError+')');err.data=uefaError;if(err.data.errorCode==6||err.data.errorCode==5||err.data.errorCode==3||err.data.errorCode==2||err.data.errorCode==1){err.loginStatus=0}else if(err.data.errorCode==4){err.loginStatus=1;err.message=err.data.errorMessage}else{err.loginStatus=2;err.message=err.data.errorMessage}}else{err.data=null;err.loginStatus=3;err.message='Server error.'}onError(err)}}},{key:'getReturnUrl',value:function getReturnUrl(loc){var returnIndex=loc.toLowerCase().lastIndexOf('returnurl');if(returnIndex<0){return escape(loc)}return loc.substr(returnIndex+10)}},{key:'getUrlLang',value:function getUrlLang(){var langPrefix='';if(location.host.substr(2,1)==='.')langPrefix=location.host.substr(0,3);return langPrefix}}]);return LoginHandler}();(function(win,$){'use strict';win.Deltatre=win.Deltatre||{};var d3=win.Deltatre;d3.loginHandler=d3.loginHandler||new LoginHandler(win,$,Cookie)})(window,jQuery);
//# sourceMappingURL=loginlegacy.js.map
