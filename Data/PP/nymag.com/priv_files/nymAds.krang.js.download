var googletag=googletag||{};googletag.cmd=googletag.cmd||[],function(){"use strict";var n=function(){function n(n,e,o){e||(e=250);var i,t;return function(){var d=o||this,a=+new Date,r=arguments;i&&i+e>a?(clearTimeout(t),t=setTimeout(function(){i=a,n.apply(d,r)},e)):(i=a,n.apply(d,r))}}function e(n){for(var e=n.offsetTop;n=n.offsetParent;)e+=n.offsetTop;return e}function o(){h.cmd.push(function(){var n=document.querySelector("meta[name=keywords]").content,e=n.toLowerCase().replace(/ /g,"-").replace(/,-/g,",").split(",");S&&e.push("index"),e.push("roadblock"),h.pubads().setTargeting("kw",e),h.pubads().setTargeting("l1",b),h.companionAds().setRefreshUnfilledSlots(!0),h.pubads().enableSingleRequest(),h.pubads().collapseEmptyDivs(!0),h.enableServices()})}function i(){return"/4088/nym.nymag/"+b}function t(n){if(n){var o=e(n),i=window.scrollY||window.pageYOffset;return o-window.innerHeight-200<=i}return!1}function d(){h.cmd.push(function(){for(var n,e=0,o=y.length;o>e;++e)n=y[e],!n.isLoaded&&t(n.el)&&(n.isLoaded=!0,n.slot.addService(h.pubads()),n.slot.setTargeting("adid",n.id),h.display(n.id))})}function a(){var n,e,o=new Date,i=!0,t=0;if(window.ad_on=window.ad_on||[],window.location.pathname.indexOf("listings")>-1)O=!0,i=!1;else if(window.ad_on.pencil_pushdown)for(n=window.ad_on.pencil_pushdown.schedule,e=n.length;e>t;++t){if(new Date(n[t].start)<o&&o<new Date(n[t].end)&&S&&n[t].urls.indexOf(x)>-1){i=!0;break}i=!1}return i}function r(n){var e=n.sz.split(",");e=e.map(function(n){return n=n.split("x"),n[0]=+n[0],n[1]=+n[1],n});var o,d=i(),a=!1,r=document.getElementById(n.id);o=h.defineSlot(d,e,n.id),t(r)&&(o.addService(h.pubads()),o.setTargeting("adid",n.id),a=!0,h.display(n.id)),""!==n.id&&y.push({id:n.id,el:r,slot:o,isLoaded:a})}function c(){for(var n=0,e=v.length;e>n;++n)1===n&&s(),r(v[n]);v.length=0,T=!0}function u(){window.NYM=window.NYM||{},window.NYM.dfp={loadAd:function(n){"pencil_pushdown"===n.name&&a()||"pencil_pushdown"!==n.name?v.push(n):O=!0,T&&r(n)},deferload:function(n){var e,o,i={},t=0;if(n.length>0||n.id)for(n[0]&&(n=n[0]),e=n.attributes,o=e.length;o>t;++t)i[e[t].name]=e[t].value},confirmTakeover:function(){}}}function l(){window.nymag.dcads&&(window.nymag.dcads.write_dc_ad=function(n){var e={};if(n.id)e.id=n.id;else if(document.getElementById("TopLeaderboard"))e.id="TopLeaderboard";else{if(!document.getElementById("pushdown"))return!1;e.id="pushdown"}return n.sz?(e.sz=n.sz,void(((S||"pencil_pushdown"===n.name)&&a()||"TopLeaderboard"!==e.id&&"pushdown"!==e.id)&&v.push(e))):!1})}function s(){var n=document.querySelector("body"),e=document.createElement("div");e.id="g-oop-1",n.appendChild(e);var o=h.defineOutOfPageSlot(i(!1),e.id).addService(h.pubads());o.setTargeting("adid",e.id),h.display(e.id)}function f(){o(),h.cmd.push(function(){c()})}function w(){var n,e=document.querySelectorAll(".nym-ad-hook"),o=e.length,i=0;!a()&&O&&--o,o!==v.length?n=window.setInterval(function(){e=document.querySelectorAll(".nym-ad-hook"),o=e.length,!a()&&O&&--o,(o===v.length||i>=10)&&(window.clearInterval(n),f()),++i},250):f()}function p(){T&&d()}function g(){var e=n(p,500);window.addEventListener("scroll",e,!1)}function m(){var n,e=document.querySelector('meta[name="content.hierarchy"]'),o=window.location.pathname.split("/");e&&(n=e.content.toLowerCase(),n.indexOf("news & features")>-1?n="news-features":n.indexOf(" channel")>0?n=n.slice(0,n.indexOf(" channel")):n.indexOf("magazine")>-1?n="magazine":n.indexOf(":")>-1&&(n=n.slice(0,n.indexOf(":")).replace(/\s/g,"")),b=n||""),3===o.length&&""===o[2]&&(S=!0,x=o[1]||""),u(),l(),document.addEventListener("DOMContentLoaded",function(){w(),g()},!1)}var h=window.googletag||{};h.cmd=h.cmd||[],window.nymag=window.nymag||{};var v=[],y=[],b="",T=!1,O=!1,S=!1,x="";return{init:m}}();window.frameElement&&window.location.href.indexOf("/content/nymag/daily/")>-1?(window.NYM=window.NYM||{},window.NYM.dfp={loadAd:function(){},deferload:function(){},confirmTakeover:function(){}}):n.init()}();

/**
 * Legacy interstitial code
 * Just put it here so we can slowly forgetâ€¦
 * https://github.com/nymag/nymFrontEnd/blob/master/scripts/nym/nymAds.js#L5-L104
 */
(function(a){a.fn.jqm=function(d){var e={overlay:50,overlayClass:"jqmOverlay",closeClass:"jqmClose",trigger:".jqModal",ajax:f,ajaxText:"",target:f,modal:f,toTop:f,onShow:f,onHide:f,onLoad:f};return this.each(function(){if(this._jqm)return c[this._jqm].c=a.extend({},c[this._jqm].c,d);b++,this._jqm=b,c[b]={c:a.extend(e,a.jqm.params,d),a:f,w:a(this).addClass("jqmID"+b),s:b},e.trigger&&a(this).jqmAddTrigger(e.trigger)})},a.fn.jqmAddClose=function(a){return l(this,a,"jqmHide")},a.fn.jqmAddTrigger=function(a){return l(this,a,"jqmShow")},a.fn.jqmShow=function(b){return this.each(function(){a.jqm.open(this._jqm,b)})},a.fn.jqmHide=function(b){return this.each(function(){a.jqm.close(this._jqm,b),window.nymag.popupInline="off",a("#fb-box-shadow").remove()})},a.jqm={hash:{},open:function(b,g){var i=c[b],k=i.c,l="."+k.closeClass,m=parseInt(i.w.css("z-index")),m=m>0?m:6e3,n=a("<div></div>").css({height:"100%",width:"100%",position:"fixed",left:0,top:0,"z-index":m-1,opacity:k.overlay/100});if(i.a)return f;i.t=g,i.a=!0,i.w.css("z-index",m),k.modal?(d[0]||j("bind"),d.push(b)):k.overlay>0?i.w.jqmAddClose(n):n=f,(i.o=n)?window.nymag.popupInline!="on"&&n.addClass(k.overlayClass).prependTo("body").fadeIn():f;if(e){a("html,body").css({height:"100%",width:"100%"});if(n){n=n.css({position:"absolute"})[0];for(var o in{Top:1,Left:1})n.style.setExpression(o.toLowerCase(),"(_=(document.documentElement.scroll"+o+" || document.body.scroll"+o+"))+'px'")}}if(k.ajax){var p=k.target||i.w,q=k.ajax,p=typeof p=="string"?a(p,i.w):a(p),q=q.substr(0,1)=="@"?a(g).attr(q.substring(1)):q;p.html(k.ajaxText).load(q,function(){k.onLoad&&k.onLoad.call(this,i),l&&i.w.jqmAddClose(a(l,i.w)),h(i)})}else l&&i.w.jqmAddClose(a(l,i.w));return k.toTop&&i.o&&i.w.before('<span id="jqmP'+i.w[0]._jqm+'"></span>').insertAfter(i.o),k.onShow?k.onShow(i):i.w.show(),h(i),f},close:function(b){var e=c[b];return e.a?(e.a=f,d[0]&&(d.pop(),d[0]||j("unbind")),e.c.toTop&&e.o&&a("#jqmP"+e.w[0]._jqm).after(e.w).remove(),e.c.onHide?e.c.onHide(e):(e.w.hide(),e.o&&e.o.fadeOut("fast",function(){a(this).remove()})),f):f},params:{}};var b=0,c=a.jqm.hash,d=[],e=a.browser.msie&&a.browser.version=="6.0",f=!1,g=a('<iframe src="javascript:false;document.write(\'\');" class="jqm"></iframe>').css({opacity:0}),h=function(b){e&&(b.o?b.o.html('<p style="width:100%;height:100%"/>').prepend(g):a("iframe.jqm",b.w)[0]||b.w.prepend(g)),i(b)},i=function(b){try{a(":input:visible",b.w)[0].focus()}catch(c){}},j=function(b){a()[b]("keypress",k)[b]("keydown",k)[b]("mousedown",k)},k=function(b){var e=c[d[d.length-1]],f=!a(b.target).parents(".jqmID"+e.s)[0];return f&&i(e),!f},l=function(b,d,e){return b.each(function(){var b=this._jqm;a(d).each(function(){this[e]||(this[e]=[],a(this).click(function(){for(var a in{jqmShow:1,jqmHide:1})for(var b in this[a])c[this[a][b]]&&c[this[a][b]].w[a](this);return f})),this[e].push(b)})})}})(jQuery);
function lbPop(e){if(e=nym.extend({name:null,height:null,width:null,divClass:"lbPop",url:null,bg:!0,closeBtn:!1,htmlText:null,overlay:50,overlayBG:null},e||{}),e.name||e.height||e.width||e.url||e.htmlText){var t=$("#lb-"+e.name),n=0;window.scrollY?(n=window.scrollY+(window.innerHeight-e.height)/2,n=n<window.scrollY?window.scrollY:n):(n=document.documentElement.scrollTop+(document.documentElement.clientHeight-e.height)/2,n=n<document.documentElement.scrollTop?document.documentElement.scrollTop:n),23>n&&(n=23),e.closeBtn&&(n+=17),t.length||(t=$("<div>").attr("id","lb-"+e.name).addClass(e.divClass).css({height:e.height,width:e.width}),e.bg||t.css({"background-color":"transparent","-moz-box-shadow":"none","-webkit-box-shadow":"none","box-shadow":"none"}),e.htmlText&&t.append(e.htmlText),t.prependTo("body").hide().jqm({overlay:e.overlay,onShow:function(n){var r=($(window).width()-e.width)/2,a=!1;r=0>r?0:r,t.css({left:r}),n.w.show(),e.overlayBG&&n.o.css("background",e.overlayBG),t.html().length||t.load(e.url,function(){var n=$(this);a=!0;var r,c;if(e.dfp){r=new RegExp("(\\%\\%CACHEBUSTER\\%\\%|\\[TIMESTAMP\\])","ig"),c=+new Date;var l=n.find("#intercept-contain a");l.attr("href",e.dfp.clickUrl+l.attr("href").replace(r,c));var o=n.find("#IMPRESSION");o.attr("data-src")?o.attr("src",e.dfp.viewUrl+o.attr("data-src").replace(r,c)):o.attr("src",e.dfp.viewUrl+o.attr("src").replace(r,c)),e.dfp.secondTracker&&n.find("#IMPRESSION2").attr("src",e.dfp.secondTracker)}n.css("background-image","none"),e.closeBtn&&(t.append("<a class='gen-close' href='#'>close</a>"),$("a.gen-close",t).click(function(){return t.jqmHide(),!1}))}),setTimeout(function(){if(!a){a=!0;var n,r,c=t;if(e.dfp){n=new RegExp("(\\%\\%CACHEBUSTER\\%\\%|\\[TIMESTAMP\\])","ig"),r=+new Date;var l=c.find("#intercept-contain a");l.attr("href",e.dfp.clickUrl+l.attr("href").replace(n,r));var o=c.find("#IMPRESSION");o.attr("data-src")?o.attr("src",e.dfp.viewUrl+o.attr("data-src").replace(n,r)):o.attr("src",e.dfp.viewUrl+o.attr("src").replace(n,r)),e.dfp.secondTracker&&c.find("#IMPRESSION2").attr("src",e.dfp.secondTracker)}c.css("background-image","none"),e.closeBtn&&(t.append("<a class='gen-close' href='#'>close</a>"),$("a.gen-close",t).click(function(){return t.jqmHide(),!1}))}},1e3)}}),$("a.close",t).click(function(){return t.jqmHide(),!1})),t.css({top:n}),t.jqmShow()}}

$.fn.smartresize||!function(n,i){if(isNaN(window.orientation)){var t=function(n,i,t){var r;return function(){function e(){t||n.apply(o,u),r=null}var o=this,u=arguments;r?clearTimeout(r):t&&n.apply(o,u),r=setTimeout(e,i||100)}},r=window.jQuery||window.Zepto;r.fn[i]=function(n){return n?this.bind("resize",t(n)):this.trigger(i)}}else{var r=window.jQuery||window.Zepto;r.fn[i]=function(n){return n?this.bind("orientationchange",n):this.trigger(i)}}}(window.jQuery||window.Zepto,"smartresize"),function(n,i){var t=function(n,i,t){var r;return function(){function e(){t||n.apply(o,u),r=null}var o=this,u=arguments;r?clearTimeout(r):t&&n.apply(o,u),r=setTimeout(e,i||100)}};jQuery.fn[i]=function(n){return n?this.bind("scroll",t(n)):this.trigger(i)}}(jQuery,"smartscroll");