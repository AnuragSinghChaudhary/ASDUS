!function(e){var t=window.location.pathname,n=function(e){for(var t=2166136261,n=t,o=0;o<e.length;++o)n^=e.charCodeAt(o),n+=(n<<1)+(n<<4)+(n<<7)+(n<<8)+(n<<24)
return n>>>0},o=function(e){return+(Math.round(e+"e+2")+"e-2")},i=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])
return e},a=function(e){return e.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,"")},r=function(e){var t=new Array
for(var n in e)e.hasOwnProperty(n)&&t.push(e[n])
return t},c=n(t),s=null,l=null,u=null,d=null,w={},g=function(e,t,n){w.pcid&&(n.product_catalog_id=w.pcid),window.fbq&&fbq(e,t,n)},f=function(){g("track","ViewContent",{content_category:s,content_ids:[c],content_type:"product",value:1,currency:"USD"})},_=function(e){var t=e.getFullYear().toString(),n=(e.getMonth()+1).toString(),o=e.getDate().toString()
return t+(n[1]?n:"0"+n[0])+(o[1]?o:"0"+o[0])},p=new Date,m=0,h=_(p),v=_(new Date((new Date).setDate(p.getDate()-30))),y=_(new Date((new Date).setDate(p.getDate()-180))),k=_(new Date(p.getFullYear(),p.getMonth(),1)),S=document.title,b=window.location.href.indexOf("kwp_4=")>0,E=0,D=null,C=function(){return localStorage&&localStorage.keyweeHistory?JSON.parse(localStorage.keyweeHistory):{}},q=function(e){localStorage&&(localStorage.keyweeHistory=JSON.stringify(e))},T=function(e){var t=C(),n=t[e]
return n||{date:e}},K=function(e,t){var n=C()
n[e]=t,q(n)},P=function(e){var t,n=T(e||h),i=o((new Date-p)/6e4),a=G()
return a>E&&(E=a),n.categories||(n.categories={}),n.categories[s]||(n.categories[s]={articles_read:0,keywee_articles_read:0,time_spent:0,category:s}),t=n.categories[s],t.last_visited_article!=S&&(t.articles_read++,b&&t.keywee_articles_read++,t.last_visited_article=S),t.time_spent=t.time_spent-m+i,m=i,K(e||h,n),n},H=function(e,t,n){return Object.keys(e).filter(function(e){return e>=t&&(!n||e<=n)})},N=function(e,t){var n=C()
return H(n,e,t).map(function(e){return n[e]})},O=function(){var e=null
return localStorage&&localStorage.keywee_oldest_visit_date&&(e=localStorage.keywee_oldest_visit_date),e},x=function(){var e=C(),t=H(e,y,v),n=O()
return n<y&&(n=null),t.length>0&&(n=t.sort()[t.length-1]),localStorage&&(n?(localStorage.keywee_oldest_visit_date=n,e[n]&&(localStorage.keywee_oldest_visit_data=JSON.stringify(e[n]))):(localStorage.removeItem("keywee_oldest_visit_date"),localStorage.removeItem("keywee_oldest_visit_data"))),n},V=function(e){var t,n=v,o={}
k<n&&(n=k),e&&(n=e),t=N(n),t.forEach(function(e){o[e.date]=e}),q(o)},M=function(e){return s&&(e["cat-"+s]=1,e.category=s),l&&(e["sect-"+l]=1,e.section=l),u&&(e["sub-sect-"+u]=1,e.sub_section=u),e},W=function(){var e={tsop:m,lop:E}
return M(e)},A=function(e){this.customizations.isCore?this.customizations.isCore.bind(this)(e):e.lov&&e.noad30>=2&&(e.core=1)},I=function(){var e=N(v),t=N(k),n=function(e){return 1==e.length?r(e[0].categories):e.reduce(function(e,t){return e.concat(r(t.categories))},[])},a=function(e,t){return 1==e.length?e[0][t]:e.reduce(function(e,n){return e+n[t]},0)},c=function(e){return e.split("_").map(function(e){return e[0]}).join("")},l=["articles_read","keywee_articles_read","time_spent"],u=n(e),w=n(t),g=u.filter(function(e){return e.category==s}),f=w.filter(function(e){return e.category==s}),_=e.length,p=t.length,m={noad30:[3,5,10],noadic30:[3,5,10],ar30d:[3,5,10],kar30d:[3,5,10],ts30d:[30,60,180]},h={noad30:_,noadic30:g.length,noadiccm:f.length,noadcm:p}
return h=M(h),d&&(h.lov=d),l.forEach(function(e){var t=c(e),n=t+"30d",i=t+"cm",r=t+"ic30d",s=t+"iccm",l=[[n,u],[i,w],[r,g],[s,f]]
l.forEach(function(t){var n=t[0],i=t[1],r=a(i,e)
h[n]=o(r)})}),Object.keys(m).forEach(function(e){for(var t=m[e],n=0,o=t.length-1;o>=0;o--)if(n=t[o-1],h[e]>=n){h["met-"+e+"_gr"+n]=1
break}}),this.customEventData&&(h=i(h,this.customEventData)),this.updateIsCoreAudience(h),h},G=function(){var e=null,t=window.pageYOffset||document.documentElement.scrollTop,n=document.body,i=document.documentElement,a=Math.max(n.scrollHeight,n.offsetHeight,i.clientHeight,i.scrollHeight,i.offsetHeight),r=window.innerHeight
return w.getArticleContainerHeight&&(e=w.getArticleContainerHeight()),e&&(a=e),o(Math.min(100,t/(a-r)*100))},L=function(){var e=G(),t=null,n=e!=D,i=o((new Date-p)/6e4),a=i>30
n&&!a&&(P(),t=this.getPeriodicEventToSend(),g("trackCustom","KWCEPA",t),D=e)},j=function(){var e=null
P(),e=this.getEventToSend(),g("trackCustom","KWCEPV",e),window.fbq&&fbq("track","PageView"),window.snowplowKW&&window.snowplowKW("trackPageView")},B=3,F=function(e){var t=this
if(e.waitFor&&!e.waitFor()&&B>0)return B-=1,void setTimeout(this.init,5e3,e)
try{this.customizations=e,this.customEventData={},w=e,x(),d=O(),w.getCategories&&(this.categories=w.getCategories(),this.categories.length>0&&(s=a(this.categories[0])),this.categories.length>1&&(l=a(this.categories[1])),this.categories.length>2&&(u=a(this.categories[2]))),w.eventListners&&w.eventListners.forEach(function(e){e.bind(t)()}),s&&(f(),V(),this.sendPageViewEvent(),setInterval(L.bind(this),3e4))}catch(e){console.log("Exception:"+e),console.log(e.stack)}},z={}
return window[e]=z,z.last_30_days_date_str=v,z.getDataBetweensDates=N,z.updateIsCoreAudience=A,z.getKeyweeHistory=C,z.updateData=P,z.today_str=h,z.getEventToSend=I,z.getPeriodicEventToSend=W,z.cleanOldData=V,z.sendPeriodicEvent=L,z.sendPageViewEvent=j,z.sendViewContentEvent=f,z.getLatestOldVisit=O,z.setLatestOldVisit=x,z.sendEvent=g,z.product_id=c,z.init=F,z}("Keywee"),function(){!function(e,t,n,o,i,a,r){e.fbq||(i=e.fbq=function(){i.callMethod?i.callMethod.apply(i,arguments):i.queue.push(arguments)},e._fbq||(e._fbq=i),i.push=i,i.loaded=!0,i.version="2.0",i.queue=[],a=t.createElement(n),a.async=!0,a.src=o,r=t.getElementsByTagName(n)[0],r.parentNode.insertBefore(a,r))}(window,document,"script","//connect.facebook.net/en_US/fbevents.js"),fbq("init","1168271029868848"),fbq("track","PageView")}(),function(e,t,n,o,i,a,r){e[i]||(e.GlobalSnowplowNamespace=e.GlobalSnowplowNamespace||[],e.GlobalSnowplowNamespace.push(i),e[i]=function(){(e[i].q=e[i].q||[]).push(arguments)},e[i].q=e[i].q||[],a=t.createElement(n),r=t.getElementsByTagName(n)[0],a.async=1,a.src=o,r.parentNode.insertBefore(a,r))}(window,document,"script","//dc8xl0ndzn2cb.cloudfront.net/sp.js","snowplowKW"),function(){function e(){var e=function(e,t,n,o){var i,a
if(n){var r=new Date
r.setTime(r.getTime()+24*n*60*60*1e3),i="; expires="+r.toGMTString()}else i=""
a=e+"="+t+i+"; path=/;",o&&(a=a+" Domain="+o),document.cookie=a},n="kwp_4",o="keywee."+n,i=new RegExp(n+"=([^&#]*)","i").exec(window.location.href),a=i&&unescape(i[1])||""
""!=a&&e(o,a,30,t),window.snowplowKW("setUserIdFromCookie",o)}var t=".nymag.com"
window.snowplowKW("newTracker","cf","pixel.keywee.co",{appId:"118",cookieDomain:t})
var n=function(e,t,n,o){var i,a
if(n){var r=new Date
r.setTime(r.getTime()+24*n*60*60*1e3),i="; expires="+r.toGMTString()}else i=""
a=e+"="+t+i+"; path=/;",o&&(a=a+" Domain="+o),document.cookie=a},o="kwp_4",i="keywee_30_m."+o,a=new RegExp(o+"=([^&]*)","i").exec(window.location.href)
a&&unescape(a[1])||""
document.cookie.includes("keywee."+o)&&!document.cookie.includes("keywee_30_m."+o)&&(n(i,Date.now(),.02,t),localStorage.keywee_30_min_sessions?(localStorage.keywee_30_min_sessions=Number.parseInt(localStorage.keywee_30_min_sessions)+1,window.fbq&&window.fbq("trackCustom","ReturningKeyweeUser",{SessionNumber:localStorage.keywee_30_min_sessions})):localStorage.keywee_30_min_sessions=0),e(),window.snowplowKW("enableActivityTracking",30,30),window.snowplowKW("trackPageView")}(),function(){var e=function(){return cat=["General"],cat}
Keywee.init({getCategories:e,pcid:308350516280326,eventListners:[]})}()
