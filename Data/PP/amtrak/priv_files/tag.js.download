(function(e){try{if(!window[e.ns]){if(!window.am){am={c:{}};var k=am.c[e.id]={};k.d=[];k.d.push("lazy:"+Date.now())}e.ns="am"}var b=window[e.ns].c[e.id];b?(b.v=b.v||{},b.v.version="1.3.2.2",b.v.debugLevel=e.debug?e.debug:0,b.v.auditLevel=e.audit?e.audit:0,b.v.sessionId=Math.random().toString().slice(2,10),b.v.href=location.href,b.v.ref=document.referrer,b.v.tagsFired=[],b.v.context="",b.v.auditTag="//ib.adnxs.com/getuid?//segment.a3cloud.net/px.png?uid=$UID&cid="+e.id,am.c.cb={tto:function(a){a=parseInt(a.uid)||0;var b=Object.keys(am.c)[0],d="ats-cid-"+b+"-sid",e=Math.random().toString().slice(2,10);if(0===a)for(am.c[b].f.setCookie(d,e+"s",!1,"/"),a=0;a<document.links.length;a+=1)b=document.links[a],"http"===b.href.substr(0,4)&&(b.href="//ib.adnxs.com/seg?add=1&redir="+encodeURIComponent(b.href));else am.c[b].f.setCookie(d,e+"x",!1,"/")}},b.f={logit:function(a){b.d.push(a+":"+new Date);0<b.v.debugLevel&&console.log(e.id+"-DEBUG:"+a)},safeEval:function(a,c){var d="";try{b.v.context=c,"undefined"!==typeof c&&null!==c&&(a="var el=am.c['"+e.id+"'].v.context;"+a),d=eval(a)}catch(g){}return d},getCookie:function(a){var b=document.cookie.indexOf(a+"="),d=b+a.length+1;if(!b&&a!==document.cookie.substring(0,a.length)||-1===b)return null;a=document.cookie.indexOf(";",d);-1===a&&(a=document.cookie.length);return unescape(document.cookie.substring(d,a))},setCookie:function(a,b,d,e,f,h){var c=new Date;c.setTime(c.getTime());d&&(d*=864E5);c=new Date(c.getTime()+d);document.cookie=a+"="+escape(b)+(d?";expires="+c.toGMTString():"")+(e?";path="+e:"")+(f?";domain="+f:"")+(h?";secure":"")},getSessionId:function(){var a="ats-cid-"+e.id+"-sid",c=b.f.getCookie(a);c||(c=Math.random().toString().slice(2,10),b.f.setCookie(a,c,!1,"/"));return c},getParentReferrer:function(a){if(a.parent===a)try{var c=a.document.referrer}catch(d){c="(iframed)"+document.referrer}else c=b.f.getParentReferrer(a.parent);return c},getParentHref:function(a){if(a.parent===a)try{var c=a.location.href}catch(d){c="(iframed)"+location.href}else c=b.f.getParentHref(a.parent);return c},evalTrigger:function(a,c){return a.trigger.result=b.f.safeEval(a.trigger.code,c)},evalVars:function(a,c,d){a.result=b.f.safeEval(a.value,d);return c.text.replace(new RegExp(a.name,"g"),a.result)},fireTag:function(a){function b(b){(new Image).src=b.text}function d(b){var a=document.getElementsByTagName("script")[0],c=document.createElement("script");c.async=!0;c.id=e.id+"-tid-"+b.id;c.src=b.text;a.parentNode.insertBefore(c,a)}function g(){var b=document.createElement("div");b.style="width:0px;height:0px;display:none;visibility:hidden";b.id=e.id+"-tid-"+a.id;b.innerHTML=a.text;document.body.appendChild(b)}function f(b){var a=document.createElement("iframe");a.id=e.id+"-tid-"+b.id;a.style="width:0px;height:0px;display:none;visibility:hidden";a.width=0;a.height=0;a.src=b.text;document.body.appendChild(a)}function h(b){var a=document.createElement("iframe");a.id=e.id+"-tid-"+b.id;a.style="width:0px;height:0px;display:none;visibility:hidden";a.width=0;a.height=0;document.body.appendChild(a);a.contentWindow.document.open().write("<html><body>"+b.text+"</body></html>");a.contentWindow.document.close()}switch(a.obj){case "img":b(a);break;case "script":d(a);break;case "div":g(a);break;case "null":break;case "iframe":f(a);break;default:h(a)}},firePreAudit:function(){b.f.fireTag({id:-1,name:"pre-audit",trigger:{name:"always",code:"true"},vars:[],obj:"img",text:b.v.auditTag})},firePostAudit:function(){b.f.fireTag({id:1,name:"post-audit",trigger:{name:"audit",code:"true"},vars:[],obj:"img",text:b.v.auditTag+"&px="+b.v.tagsFired.join()})},fireDefaultTag:function(a){var c;if(b.f.evalTrigger(a)){for(c=0;c<a.vars.length;c+=1){var d=a.vars[c];a.text=b.f.evalVars(d,a)}b.v.tagsFired.push(a.id);b.f.fireTag(a)}},prepareEventTag:function(a){window.addEventListener(a.trigger.event,function(c){try{var d;if(b.f.evalTrigger(a,c.target)){for(d=0;d<a.vars.length;d+=1){var g=a.vars[d];a.text=b.f.evalVars(g,a,c.target)}b.v.tagsFired.push(a.id);b.f.fireTag(a)}}catch(f){console.log(e.id+"-ERR: trapped event error: "+f.message),document.createElement("img").src="//ib.adnxs.com/getuid?//segment.a3cloud.net/px.png?uid=$UID&cid="+e.id+"&err=event&msg="+escape(f.message)}},!1)},main:function(a){var c;b.v.sessionId=b.f.getSessionId();b.v.href=b.f.getParentHref(window);b.v.ref=b.f.getParentReferrer(window);b.v.debugLevel=/amdebug=1/i.test(b.v.href)?1:b.v.debugLevel;b.v.auditTag=b.v.auditTag+"&sid="+b.v.sessionId+"&url="+escape(b.v.ref);b.v.atsCookie=b.f.getCookie("ats-cid-"+e.id+"-sid");1<b.v.auditLevel&&b.f.firePreAudit();for(c=0;c<a.length;c+=1){var d=a[c];d.trigger.event&&""!==d.trigger.event?b.f.prepareEventTag(d):b.f.fireDefaultTag(d)}b.v.atsCookie&&9>b.v.atsCookie.length&&setTimeout(function(){var a=Object.keys(am.c)[0];am.c[a].f.fireTag({id:"321",name:"3to1",obj:"script",text:"//ib.adnxs.com/getuidp?callback=am.c.cb.tto",trigger:{name:"321all",code:"true"},vars:[]})},Math.random().toString().slice(2,6));0<b.v.auditLevel&&b.f.firePostAudit();b.d.push("finish:"+Date.now())}},b.t=[{"name":"audit","id":0,"text":"{auditUrl}&vars=","trigger":{"name":"all","code":true,"event":""},"vars":[{"name":"{auditUrl}","value":"am.c['AM-141529'].v.auditTag"}],"obj":"img"},{"name":"captureEvent","id":"974212","text":"console.log('am.custom event listener loaded');","trigger":{"name":"addEventListener","code":"document.body.addEventListener('am.custom',function(e){console.log('am.custom listener:'+JSON.stringify(e.detail));setTimeout(function(){am.c['AM-141529'].f.fireTag({id:'am.custom',name:'am.custom',text:'https://ib.adnxs.com/getuid?//segment.a3cloud.net/px.png?uid=$UID&cid=AM-141529&sid='+am.c['AM-141529'].v.sessionId+'&url=&vars=data:'+escape(encodeURIComponent(JSON.stringify(e.detail.message))),obj:'img',trigger:{name:'true',code:true,event:'',result:true},vars:[]});am.c['AM-141529'].f.fireTag({id:'974212',name:'conversion',text:'https://secure.adnxs.com/px?id=974212&t=2',obj:'img',trigger:{name:'true',code:true,event:'',result:true},vars:[]});console.log('am.custom resolved.');},150);});true;","event":""},"vars":[],"obj":null}],b.f.main(b.t)):(console.log(e.id+"-ERR: namespace _NOT_ found"),document.createElement("img").src="//ib.adnxs.com/getuid?//segment.a3cloud.net/px.png?uid=$UID&cid="+e.id+"&err=no-namespace")}catch(a){console.log(e.id+"-ERR: trapped error: "+a.message),document.createElement("img").src="//ib.adnxs.com/getuid?//segment.a3cloud.net/px.png?uid=$UID&cid="+e.id+"&err=unknown&msg="+escape(a.message)}})({ns:"am",id:"AM-141529",audit:0,debug:0});