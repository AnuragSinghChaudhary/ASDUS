define(["jquery","eventDispatcher","handlebars","savedItems"],function(e,t,n,r){function g(e,t){switch(t){case"looks-detail":return y(e,t);case"product-tiles-grid":case"product-tiles-grid-rest":case"search-results-grid":case"search-results-grid-rest":return b(e,t);case"looks-grid-item":return E(e,t);case"search-looks-grid":case"search-looks-grid-rest":return S(e,t);case"product-tiles-grid-2":case"product-tiles-grid-3":case"product-tiles-grid-reset":return w(e,t);case"header-my-account-menu":return x(e,t)}}function y(t){var r,o;u=2,v="",p=e("#product-tiles-grid").html(),d=n.compile(p),o=e.map(t[0],function(t){r=t.items,e("."+i.LOOKS_GALLERY_CLASS).removeClass().addClass(i.LOOKS_GALLERY_CLASS),u++});for(var a=0;a<r.length;a++)r.length>4&&a%5===0&&(r[a].lookGalleryBigImage=!0),h=s.GRID,r[a].isFeatured!==undefined&&(h+=" "+s.GRID+s.FEATURED+r[a].isFeatured),h+=" "+s.GRID+s.MEDIUM,h+=" "+s.GRID+s.SMALL,r[a].productClass=h,r[a].productLink=s.LINK+r[a].productCode+"?listName=LookDetailsCarouselComponent&position="+(a+1),v+=d(r[a]);return e("."+i.LOOKS_GALLERY_CLASS).addClass(i.LOOKS_GALLERY_CLASS+"-"+r.length+"-items"),v+='<div class="'+i.CONTAINER_ITEMS+'"></div>',{html:v}}function b(t,i){var o=t.products;u=1,v="";var a=e("#"+i.replace("-rest","")).html(),p=typeof t.numberOfPages=="undefined"?-1:t.numberOfPages,g=typeof t.currentPage=="undefined"?-1:t.currentPage;d=n.compile(a),f=typeof o.maxStandard!="undefined"?o.maxStandard:o.items.length,l=typeof o.maxMedium!="undefined"?o.maxMedium:o.items.length,c=typeof o.maxSmall!="undefined"?o.maxSmall:o.items.length,f=f===null?o.items.length:f,m=i.indexOf("-rest")>2||p-1==g;for(var y in o.items){h=s.GRID,typeof o.items[y].isFeatured!="undefined"&&(h+=" "+s.GRID+s.FEATURED+o.items[y].isFeatured),u<=l?h+=" "+s.GRID+s.MEDIUM:h+=" "+s.GRID+s.MEDIUM+s.REMOVE,u<=c?h+=" "+s.GRID+s.SMALL:h+=" "+s.GRID+s.SMALL+s.REMOVE,o.items[y].productClass=h;if(!(u<=f))break;v+=d(o.items[y]),u++}return v+='<div class="'+s.LOAD_MORE_CONTAINER+' _no-content"></div>',e('a[href="'+i+'"]').attr("href",i+"-rest"),r.fillSavedItems(),{html:v,hideButton:m}}function w(t,r){var i=t.products;u=1,v="",p=e("#"+r).html(),d=n.compile(p),f=typeof i.maxStandard!="undefined"?i.maxStandard:i.items.length,l=typeof i.maxMedium!="undefined"?i.maxMedium:i.items.length,c=typeof i.maxSmall!="undefined"?i.maxSmall:i.items.length;for(var o in i.items){h=s.GRID,typeof i.items[o].isFeatured!="undefined"&&(h+=" "+s.GRID+s.FEATURED+i.items[o].isFeatured),u<=l?h+=" "+s.GRID+s.MEDIUM:h+=" "+s.GRID+s.MEDIUM+s.REMOVE,u<=c?h+=" "+s.GRID+s.SMALL:h+=" "+s.GRID+s.SMALL+s.REMOVE,i.items[o].productClass=h,i.items[o].productLink=s.LINK;if(!(u<=f))break;v+=d(i.items[o]),u++}return v+='<div class="'+s.LOAD_MORE_CONTAINER+' _no-content"></div>',{html:v}}function E(t,r){var i=t.looks;return a=e("."+o.GRID+":visible").length+1,m=!0,u=1,v="",p=e("#"+r).html(),d=n.compile(p),l=typeof i.maxMedium!="undefined"?i.maxMedium:i.items.length,c=typeof i.maxSmall!="undefined"?i.maxSmall:i.items.length,i.items.forEach(function(e){h=o.GRID,u<=l?h+=" "+o.GRID+o.MEDIUM:h+=" "+o.GRID+o.MEDIUM+o.REMOVE,u<=c?h+=" "+o.GRID+o.SMALL:h+=" "+o.GRID+o.SMALL+o.REMOVE,e.lookClass=h,e.haveNumbers=i.haveNumbers,e.lookLink=o.LINK,e.lookCount=a,v+=d(e),u++,a++}),v+='<div class="'+o.LOAD_MORE_CONTAINER+' _no-content"></div>',{html:v,hideButton:m}}function S(t,r){var i=t.looks;return a=e("."+o.GRID).length+1,u=1,v="",r==="search-looks-grid-rest"?m=!0:m=!1,p=e("#"+r).html(),d=n.compile(p),l=typeof i.maxMedium!="undefined"?i.maxMedium:i.items.length,c=typeof i.maxSmall!="undefined"?i.maxSmall:i.items.length,i.items.forEach(function(e){h=o.GRID,u<=l?h+=" "+o.GRID+o.MEDIUM:h+=" "+o.GRID+o.MEDIUM+o.REMOVE,u<=c?h+=" "+o.GRID+o.SMALL:h+=" "+o.GRID+o.SMALL+o.REMOVE,e.lookClass=h,e.haveNumbers=i.haveNumbers,e.lookLink=o.LINK,e.lookCount=a,v+=d(e),u++,a++}),v+='<div class="'+o.LOAD_MORE_CONTAINER+' _no-content"></div>',e('a[href="'+r+'"]').attr("href",r+"-rest"),{html:v,hideButton:m}}function x(t,r){var i=t.myOrders,s=t.favoritesCount,o={};return o.myOrders=i,o.favoritesCount=s,p=e("#"+r).html(),d=n.compile(p),{html:d(o)}}function T(){}var i={LOOKS_GALLERY_CLASS:"look-gallery",CONTAINER_ITEMS:"content-looks-gallery-items"},s={GRID:"product-tiles-grid-item",MEDIUM:"-medium",SMALL:"-small",REMOVE:"-remove",FEATURED:"-featured",LINK:"/-p-",LOAD_MORE_CONTAINER:"product-tiles-grid-load-content"},o={GRID:"looks-grid-item",MEDIUM:"-medium",SMALL:"-small",REMOVE:"-remove",LINK:"/look/",LOAD_MORE_CONTAINER:"looks-grid-load-content"},u=1,a=1,f,l,c,h="",p="",d="",v="",m=!1;return t.dispatchAndListen("jsonHtml",T),{compiler:function(e,t){return g(e,t)}}});